% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\documentclass[
]{article}
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath,amssymb}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\usepackage{amsmath}
\usepackage[backend=biber,style=authoryear]{biblatex}
\addbibresource{citations.bib}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\usepackage{caption}
\usepackage{graphicx}
\usepackage{siunitx}
\usepackage{hhline}
\usepackage{calc}
\usepackage{tabularx}
\usepackage{adjustbox}
\usepackage{hyperref}
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={ECB Project},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{ECB Project}
\author{}
\date{\vspace{-2.5em}}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{3}
\tableofcontents
}
\newpage

\section{Preliminaries}\label{preliminaries}

\subsection{Setup}\label{setup}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Clear memory }
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{())}

\CommentTok{\# Load here package to enable finding script loading other packages}
\FunctionTok{require}\NormalTok{(here)}

\CommentTok{\# Set directory}
\FunctionTok{getwd}\NormalTok{()}
\FunctionTok{setwd}\NormalTok{(}\StringTok{"..."}\NormalTok{) }

\CommentTok{\# Load packages \& helper functions}
\FunctionTok{source}\NormalTok{(}\FunctionTok{here}\NormalTok{(}\StringTok{"helpers/packages.R"}\NormalTok{))}
\FunctionTok{source}\NormalTok{(}\FunctionTok{here}\NormalTok{(}\StringTok{"helpers/auto\_ARIMA\_replic.R"}\NormalTok{))}

\CommentTok{\# Api key for data}
\FunctionTok{fredr\_set\_key}\NormalTok{(}\StringTok{"e0169694a62c1337f1969e3872605eca"}\NormalTok{)}

\CommentTok{\# Dates (to automatically get the latest data from API calls)}
\NormalTok{start\_date }\OtherTok{\textless{}{-}} \StringTok{"1999{-}01{-}01"}
\NormalTok{end\_date }\OtherTok{\textless{}{-}} \FunctionTok{Sys.Date}\NormalTok{()}

\CommentTok{\# For replication }
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{2025}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{Interactive Option
Selection}\label{interactive-option-selection}

\begin{itemize}
\tightlist
\item
  Use Hamilton Filter:

  \begin{itemize}
  \tightlist
  \item
    TRUE: Selects Hamilton method for output gap estimation
  \item
    FALSE: Selects Hodrick-Prescott method for output gap estimation
  \end{itemize}
\item
  Use Inflation Expectations:

  \begin{itemize}
  \tightlist
  \item
    TRUE: The models used for forecasting will use 12-month ahead
    inflation expectations from the ECB survey of professional forecasts
    (average).
  \item
    FALSE: The models used for forecasting will use realised inflation
  \end{itemize}
\item
  Use Formula

  \begin{itemize}
  \tightlist
  \item
    Formula 1: Actual interest rate regressed on inflation and output
    gaps\\
  \item
    Formula 2: Shadow interest rate regressed on inflation and output
    gaps
  \item
    Formula 3: Actual interest rate regressed on the one-quarter lag of
    the interest rate and on inflation and output gaps
  \item
    Formula 4: Shadow interest rate regressed on the one-quarter lag of
    the shadow interest rate and on inflation and output gaps
  \end{itemize}
\item
  Format:

  \begin{itemize}
  \tightlist
  \item
    html: For outputting in console or knitting to html
  \item
    latex: For knitting to pdf
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Related to Analysis}
\NormalTok{USE\_HAMILTON\_FILTER }\OtherTok{\textless{}{-}} \ConstantTok{TRUE}
\NormalTok{USE\_INFLATION\_EXPECTATIONS }\OtherTok{\textless{}{-}} \ConstantTok{FALSE}
\NormalTok{USE\_FORMULA }\OtherTok{\textless{}{-}} \StringTok{"Formula 3"}

\CommentTok{\# Related to Document Output}
\NormalTok{format }\OtherTok{\textless{}{-}} \StringTok{"html"}
\NormalTok{format }\OtherTok{\textless{}{-}} \StringTok{"latex"} 
\NormalTok{save\_figures }\OtherTok{\textless{}{-}} \ConstantTok{FALSE} \CommentTok{\#note: format has to be set to latex}
\end{Highlighting}
\end{Shaded}

\clearpage

\section{Data}\label{data}

\subsection{Sources \& Explanations}\label{sources-explanations}

\begin{itemize}
\item
  FRED Data Source: European Central Bank, ECB Deposit Facility Rate for
  Euro Area {[}ECBDFR{]}, retrieved from FRED, Federal Reserve Bank of
  St.~Louis; \url{https://fred.stlouisfed.org/series/ECBDFR}. The data
  is the Deposit Facility and is directly reprinted from the ECB. It's
  in Percent and not seasonally adjusted. The ECB Monetary Policy is
  steered through this rate
\item
  Shadow Interest Rate: The Shadow rate was developed by
  \cite{wuTimeVaryingLowerBound2017} and does quantify a hypothetical
  removal of the ZLB. The rate does not track 1:1 on the deposit
  facility in the data before the ZLB, instead being closer to the
  refinancing rate. (maybe need to adjust)
\item
  GDP: The GDP Data is quarterly real GDP in 2010 Euros in million
  retrieved from FRED via Eurostat. The data is seasonally adjusted.
\item
  Potential GDP: Either estimated with the Hodrick-Prescott filter, or
  the Hamilton filter, based on the formulae below: \[
      \begin{aligned}
      \text{HP Filter:} \quad & \min_{\tau} \left( \sum_{t=1}^{T} (y_t - \tau_t)^2 + \lambda \sum_{t=2}^{T-1} \left[ (\tau_{t+1} - \tau_t) - (\tau_t - \tau_{t-1}) \right]^2 \right) \\
      \text{Hamilton:} \quad & y_t = \beta_0 + \sum_{j=1}^{p} \beta_j y_{t-h-j+1} + v_t \quad \text{(where } v_t \text{ is the cycle)}
      \end{aligned}
    \]
\item
  Inflation:

  \begin{itemize}
  \tightlist
  \item
    Realised: The Inflation data is from Eurostat and called HICP. It's
    the index the ECB uses for Inflation and is not seasonally adjusted.
  \item
    Expectations: Expected Inflation is the ECB's survey of professional
    forecasters. It forecasts the HICP 12 months in advance.
  \end{itemize}
\end{itemize}

\subsection{Loading \& Preparation Data}\label{loading-preparation-data}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-} 1. ECB Deposit Facility Rate \& Shadow Rate {-}{-}{-}}
\NormalTok{ecb\_rate\_daily }\OtherTok{\textless{}{-}} \FunctionTok{fredr}\NormalTok{(}\AttributeTok{series\_id =} \StringTok{"ECBDFR"}\NormalTok{, }\AttributeTok{observation\_start =} \FunctionTok{as.Date}\NormalTok{(start\_date))}
\NormalTok{ecb\_rate\_q }\OtherTok{\textless{}{-}}\NormalTok{ ecb\_rate\_daily }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{quarter =} \FunctionTok{as.yearqtr}\NormalTok{(date)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(quarter) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{rate =} \FunctionTok{last}\NormalTok{(value)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{date =} \FunctionTok{as.Date}\NormalTok{(quarter))}
\CommentTok{\# Wu{-}Xia Shadow Rate }
\NormalTok{shadow\_rate\_daily }\OtherTok{=} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{readMat}\NormalTok{(}\StringTok{"data/shadowrate\_ECB.mat"}\NormalTok{)) }
\FunctionTok{colnames}\NormalTok{(shadow\_rate\_daily) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"DATE"}\NormalTok{, }\StringTok{"shadowrate"}\NormalTok{)}
\NormalTok{shadow\_rate\_daily}\SpecialCharTok{$}\NormalTok{DATE }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(shadow\_rate\_daily}\SpecialCharTok{$}\NormalTok{DATE, }\StringTok{"01"}\NormalTok{), }\AttributeTok{format=}\StringTok{"\%Y\%m\%d"}\NormalTok{)}
\NormalTok{shadow\_rate\_daily}\SpecialCharTok{$}\NormalTok{quarter }\OtherTok{\textless{}{-}} \FunctionTok{as.yearqtr}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(shadow\_rate\_daily}\SpecialCharTok{$}\NormalTok{DATE))}
\NormalTok{shadow\_rate\_daily}\SpecialCharTok{$}\NormalTok{month }\OtherTok{\textless{}{-}} \FunctionTok{as.yearmon}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(shadow\_rate\_daily}\SpecialCharTok{$}\NormalTok{DATE))}
\NormalTok{quarterly\_shadow }\OtherTok{=} \FunctionTok{aggregate}\NormalTok{(shadowrate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ quarter, }\AttributeTok{data=}\NormalTok{shadow\_rate\_daily, }\AttributeTok{FUN=}\NormalTok{mean, }\AttributeTok{na.rm=}\NormalTok{T)}
\NormalTok{monthly\_shadow }\OtherTok{=} \FunctionTok{aggregate}\NormalTok{(shadowrate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ month, }\AttributeTok{data=}\NormalTok{shadow\_rate\_daily, }\AttributeTok{FUN=}\NormalTok{mean, }\AttributeTok{na.rm=}\NormalTok{T)}

\CommentTok{\# {-}{-}{-} 2. HICP Inflation (Euro Area) {-}{-}{-}}
\NormalTok{inflation\_data }\OtherTok{\textless{}{-}} \FunctionTok{get\_eurostat}\NormalTok{(}\StringTok{"prc\_hicp\_manr"}\NormalTok{, }\AttributeTok{filters =} \FunctionTok{list}\NormalTok{(}\AttributeTok{geo =} \StringTok{"EA"}\NormalTok{, }\AttributeTok{coicop =} \StringTok{"CP00"}\NormalTok{), }\AttributeTok{type =} \StringTok{"label"}\NormalTok{)}
\NormalTok{inflation\_q }\OtherTok{\textless{}{-}}\NormalTok{ inflation\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(time }\SpecialCharTok{\textgreater{}=}\NormalTok{ start\_date) }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(}\AttributeTok{date =}\NormalTok{ time, }\AttributeTok{inflation =}\NormalTok{ values) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{quarter =} \FunctionTok{as.yearqtr}\NormalTok{(date)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(quarter) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{inflation =} \FunctionTok{mean}\NormalTok{(inflation, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{date =} \FunctionTok{as.Date}\NormalTok{(quarter))}

\CommentTok{\#inflation expectations}
\NormalTok{inflation\_exp }\OtherTok{\textless{}{-}} \FunctionTok{rdb}\NormalTok{(}\AttributeTok{ids =} \StringTok{"ECB/SPF/M.U2.HICP.POINT.P12M.Q.AVG"}\NormalTok{)}
\CommentTok{\#inflation\_exp \textless{}{-} rdb(ids = "ECB/SPF/M.U2.HICP.POINT.P24M.Q.AVG")}
\NormalTok{inflation\_exp\_q }\OtherTok{\textless{}{-}}\NormalTok{ inflation\_exp }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{quarter =} \FunctionTok{as.yearqtr}\NormalTok{(period)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(quarter) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{exp\_inflation =} \FunctionTok{last}\NormalTok{(original\_value)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{date =} \FunctionTok{as.Date}\NormalTok{(quarter))}

\CommentTok{\#P12M : 12{-}month ahead forecasts}
\NormalTok{inflation\_q}\SpecialCharTok{$}\NormalTok{exp\_inflation }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\ConstantTok{NA}\NormalTok{,}\DecValTok{3}\NormalTok{),}\FunctionTok{as.numeric}\NormalTok{(inflation\_exp\_q}\SpecialCharTok{$}\NormalTok{exp\_inflation),}\ConstantTok{NA}\NormalTok{)}
\CommentTok{\#P24M : 24{-}month ahead forecasts}
\CommentTok{\#inflation\_q$exp\_inflation = c(rep(NA,7),as.numeric(inflation\_exp\_q$exp\_inflation[1:101]))}

\CommentTok{\# {-}{-}{-} 3. Real GDP and Estimated Output Gap {-}{-}{-}}
\CommentTok{\# a) Real GDP for the Euro Area. The series ID is CLVMNACSCAB1GQE\_A.}
\NormalTok{gdp\_q }\OtherTok{\textless{}{-}} \FunctionTok{fredr}\NormalTok{(}
  \AttributeTok{series\_id =} \StringTok{"CLVMEURSCAB1GQEA19"}\NormalTok{,}
  \AttributeTok{observation\_start =} \FunctionTok{as.Date}\NormalTok{(start\_date)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{quarter =} \FunctionTok{as.yearqtr}\NormalTok{(date)) }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(quarter, }\AttributeTok{real\_gdp =}\NormalTok{ value) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{log\_real\_gdp =} \FunctionTok{log}\NormalTok{(real\_gdp)) }

\CommentTok{\# b) Estimate Potential GDP (the trend) using the HP Filter on the log of real GDP.}
\CommentTok{\# The lambda value of 1600 is standard for quarterly data.}
\NormalTok{hp\_gdp }\OtherTok{\textless{}{-}} \FunctionTok{hpfilter}\NormalTok{(gdp\_q}\SpecialCharTok{$}\NormalTok{log\_real\_gdp, }\AttributeTok{freq =} \DecValTok{1600}\NormalTok{)}
\NormalTok{gdp\_q}\SpecialCharTok{$}\NormalTok{potential\_gdp\_log }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(hp\_gdp}\SpecialCharTok{$}\NormalTok{trend)}
\NormalTok{ham\_gdp\_cycle }\OtherTok{\textless{}{-}} \FunctionTok{filter\_hamilton}\NormalTok{(gdp\_q}\SpecialCharTok{$}\NormalTok{log\_real\_gdp, }\AttributeTok{p =} \DecValTok{4}\NormalTok{, }\AttributeTok{horizon =} \DecValTok{8}\NormalTok{)}
\NormalTok{gdp\_q}\SpecialCharTok{$}\NormalTok{potential\_gdp\_log\_ham }\OtherTok{\textless{}{-}}\NormalTok{ gdp\_q}\SpecialCharTok{$}\NormalTok{log\_real\_gdp }\SpecialCharTok{{-}}\NormalTok{ ham\_gdp\_cycle}

\CommentTok{\# Combine all data into a single data frame}
\NormalTok{data }\OtherTok{\textless{}{-}}\NormalTok{ ecb\_rate\_q }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(quarter, rate) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(inflation\_q, }\AttributeTok{by =} \StringTok{"quarter"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(gdp\_q, }\AttributeTok{by =} \StringTok{"quarter"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(quarterly\_shadow, }\AttributeTok{by =} \StringTok{"quarter"}\NormalTok{) }

\CommentTok{\# Create model variables}
\NormalTok{data }\OtherTok{\textless{}{-}}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{realised\_inflation\_gap =}\NormalTok{ inflation }\SpecialCharTok{{-}} \FloatTok{2.0}\NormalTok{,}
    \AttributeTok{exp\_inflation\_gap =}\NormalTok{ exp\_inflation }\SpecialCharTok{{-}}\FloatTok{2.0}\NormalTok{,}
    \AttributeTok{output\_gap\_hp =} \DecValTok{100} \SpecialCharTok{*}\NormalTok{ (log\_real\_gdp }\SpecialCharTok{{-}}\NormalTok{ potential\_gdp\_log),}
    \AttributeTok{output\_gap\_ham =} \DecValTok{100} \SpecialCharTok{*}\NormalTok{ (log\_real\_gdp }\SpecialCharTok{{-}}\NormalTok{ potential\_gdp\_log\_ham),}
    \AttributeTok{rate\_lag =} \FunctionTok{lag}\NormalTok{(rate, }\DecValTok{1}\NormalTok{),}
    \AttributeTok{shadowrate =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{      quarter }\SpecialCharTok{\textless{}} \StringTok{"2012 Q3"} \SpecialCharTok{|}\NormalTok{ quarter }\SpecialCharTok{\textgreater{}=} \StringTok{"2022 Q3"} \SpecialCharTok{\textasciitilde{}}\NormalTok{ rate,}
      \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}}\NormalTok{ shadowrate),}
    \AttributeTok{shadowrate\_lag =} \FunctionTok{lag}\NormalTok{(shadowrate, }\DecValTok{1}\NormalTok{))}

\CommentTok{\# Remove last row since no output data}
\NormalTok{data }\OtherTok{=} \FunctionTok{subset}\NormalTok{(data, quarter }\SpecialCharTok{\textless{}} \StringTok{"2025 Q3"}\NormalTok{)}

\CommentTok{\# Clean environment}
\FunctionTok{rm}\NormalTok{(gdp\_q, hp\_gdp, ecb\_rate\_daily, ecb\_rate\_q, inflation\_data, inflation\_q,}
\NormalTok{   inflation\_exp, inflation\_exp\_q, monthly\_shadow, quarterly\_shadow, shadow\_rate\_daily)}
\end{Highlighting}
\end{Shaded}

\subsection{Options Configuration}\label{options-configuration}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Choices in setup chunk}

\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-} 1. Filter selection for output gap estimation {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}

\CommentTok{\# TRUE  = Use Hamilton Filter (newer, arguably more robust)}
\CommentTok{\# FALSE = Use HP Filter (classic approach)}

\CommentTok{\# Applying selection}
\ControlFlowTok{if}\NormalTok{ (USE\_HAMILTON\_FILTER) \{}
\NormalTok{    data}\SpecialCharTok{$}\NormalTok{output\_gap }\OtherTok{\textless{}{-}}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{output\_gap\_ham}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"* CONFIGURATION: Using Hamilton Filter for output gap estimation."}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{  data}\SpecialCharTok{$}\NormalTok{output\_gap }\OtherTok{\textless{}{-}}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{output\_gap\_hp }
  \FunctionTok{cat}\NormalTok{(}\StringTok{"* CONFIGURATION: Using HP Filter for output gap estimation."}\NormalTok{) \}}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  CONFIGURATION: Using Hamilton Filter for output gap estimation.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-} 2. Inflation expectations choice {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}

\CommentTok{\# TRUE  = Use inflation expectations from ECB survey of professional forecasts}
\CommentTok{\# FALSE = Use realised inflation}

\CommentTok{\# Applying selection}
\ControlFlowTok{if}\NormalTok{ (USE\_INFLATION\_EXPECTATIONS) \{}
\NormalTok{    data}\SpecialCharTok{$}\NormalTok{inflation\_gap }\OtherTok{\textless{}{-}}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{exp\_inflation\_gap}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"* CONFIGURATION: Using inflation expectations in Taylor Rule forecasting."}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{  data}\SpecialCharTok{$}\NormalTok{inflation\_gap }\OtherTok{\textless{}{-}}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{realised\_inflation\_gap }
  \FunctionTok{cat}\NormalTok{(}\StringTok{"* CONFIGURATION: Using realised inflation in Taylor Rule forecasting."}\NormalTok{) \}}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  CONFIGURATION: Using realised inflation in Taylor Rule forecasting.
\end{itemize}

\subsection{Raw Data Plots}\label{raw-data-plots}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Data must be in long format for a faceted plot}
\NormalTok{plot\_data }\OtherTok{\textless{}{-}}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{c}\NormalTok{(rate, inflation, exp\_inflation, output\_gap\_hp, output\_gap\_ham),}
               \AttributeTok{names\_to =} \StringTok{"series"}\NormalTok{,}
               \AttributeTok{values\_to =} \StringTok{"value"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{series =} \FunctionTok{factor}\NormalTok{(series, }
    \AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"rate"}\NormalTok{, }\StringTok{"inflation"}\NormalTok{, }\StringTok{"exp\_inflation"}\NormalTok{, }\StringTok{"output\_gap\_hp"}\NormalTok{, }\StringTok{"output\_gap\_ham"}\NormalTok{),}
    \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Deposit Rate"}\NormalTok{, }\StringTok{"(Realised) Inflation"}\NormalTok{, }\StringTok{"(Expected) Inflation"}\NormalTok{, }\StringTok{"Output Gap (HP)"}\NormalTok{, }\StringTok{"Output Gap (Hamilton)"}\NormalTok{)))}

\NormalTok{raw\_plot }\OtherTok{=} \FunctionTok{ggplot}\NormalTok{(plot\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ date, }\AttributeTok{y =}\NormalTok{ value)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ series), }\AttributeTok{linewidth =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ series, }\AttributeTok{scales =} \StringTok{"free\_y"}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_date}\NormalTok{(}\AttributeTok{date\_breaks =} \StringTok{"5 years"}\NormalTok{, }\AttributeTok{date\_labels =} \StringTok{"\%Y"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Raw Data Plots"}\NormalTok{, }\AttributeTok{subtitle =} \StringTok{"Y axis in \%"}\NormalTok{, }\AttributeTok{x =} \StringTok{""}\NormalTok{, }\AttributeTok{y =} \StringTok{""}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}
     \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{5}\NormalTok{)),}
     \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey30"}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{10}\NormalTok{)),}
     \AttributeTok{axis.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
     \AttributeTok{axis.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{),}
     \AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{,}
     \AttributeTok{panel.grid.major.x =} \FunctionTok{element\_line}\NormalTok{(}\AttributeTok{linewidth =} \FloatTok{0.525}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey83"}\NormalTok{))}
\NormalTok{raw\_plot}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{ECB-Project_files/figure-latex/data_plots-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
  \FunctionTok{ggsave}\NormalTok{(}\AttributeTok{filename =} \StringTok{"raw\_data\_plot.png"}\NormalTok{, }\AttributeTok{path =} \StringTok{"figures/"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ raw\_plot)\}}
\FunctionTok{rm}\NormalTok{(plot\_data)}
\end{Highlighting}
\end{Shaded}

\subsection{Data Properties}\label{data-properties}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Helper function to run ADF and KPSS tests and return dataframe fit for table}

\NormalTok{check\_stationarity }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(y, var\_name) \{}
  
  \CommentTok{\# Running tests and getting pvalues}
\NormalTok{  adf\_result }\OtherTok{\textless{}{-}}\NormalTok{ tseries}\SpecialCharTok{::}\FunctionTok{adf.test}\NormalTok{(y, }\AttributeTok{alternative =} \StringTok{"stationary"}\NormalTok{)}
\NormalTok{  kpss\_result }\OtherTok{\textless{}{-}}\NormalTok{ tseries}\SpecialCharTok{::}\FunctionTok{kpss.test}\NormalTok{(y, }\AttributeTok{null =} \StringTok{"Level"}\NormalTok{)}
\NormalTok{  adf\_p }\OtherTok{\textless{}{-}}\NormalTok{ adf\_result}\SpecialCharTok{$}\NormalTok{p.value}
\NormalTok{  kpss\_p }\OtherTok{\textless{}{-}}\NormalTok{ kpss\_result}\SpecialCharTok{$}\NormalTok{p.value}
  
  \CommentTok{\# Automatically assign interpretation (yes, modular!)}
\NormalTok{  interpretation }\OtherTok{\textless{}{-}} \StringTok{""}
  \ControlFlowTok{if}\NormalTok{ (adf\_p }\SpecialCharTok{\textless{}} \FloatTok{0.05} \SpecialCharTok{\&\&}\NormalTok{ kpss\_p }\SpecialCharTok{\textgreater{}} \FloatTok{0.05}\NormalTok{) \{}
\NormalTok{    interpretation }\OtherTok{\textless{}{-}} \StringTok{"Stationary I(0): ADF rejects unit root, KPSS confirms stationarity."}\NormalTok{ \} }
  \ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (adf\_p }\SpecialCharTok{\textgreater{}} \FloatTok{0.05} \SpecialCharTok{\&\&}\NormalTok{ kpss\_p }\SpecialCharTok{\textless{}} \FloatTok{0.05}\NormalTok{) \{}
\NormalTok{    interpretation }\OtherTok{\textless{}{-}} \StringTok{"Non{-}Stationary I(1): ADF confirms unit root, KPSS rejects stationarity."}\NormalTok{ \} }
  \ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (adf\_p }\SpecialCharTok{\textgreater{}} \FloatTok{0.05} \SpecialCharTok{\&\&}\NormalTok{ kpss\_p }\SpecialCharTok{\textgreater{}} \FloatTok{0.05}\NormalTok{) \{}
\NormalTok{    interpretation }\OtherTok{\textless{}{-}} \StringTok{"Conflicting Results: ADF confirms unit root, while KPSS suggests stationarity."}\NormalTok{ \} }
  \ControlFlowTok{else}\NormalTok{ \{ }\CommentTok{\# adf\_p \textless{} 0.05 \&\& kpss\_p \textless{} 0.05}
\NormalTok{    interpretation }\OtherTok{\textless{}{-}} \StringTok{"Conflicting Results: ADF rejects unit root, while KPSS rejects stationarity."}\NormalTok{ \}}
  
  \CommentTok{\# Export results}
  \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Variable =}\NormalTok{ var\_name,}
            \StringTok{\textasciigrave{}}\AttributeTok{ADF p{-}value}\StringTok{\textasciigrave{}} \OtherTok{=}\NormalTok{ adf\_p,}
            \StringTok{\textasciigrave{}}\AttributeTok{KPSS p{-}value}\StringTok{\textasciigrave{}} \OtherTok{=}\NormalTok{ kpss\_p,}
             \AttributeTok{Result =}\NormalTok{ interpretation, }\AttributeTok{check.names =} \ConstantTok{FALSE}\NormalTok{) \}}


\CommentTok{\# Similar helper function, but for cointegration tests}
\NormalTok{check\_coint }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(y1,y2, var\_name1, var\_name2)\{ }
  
  \CommentTok{\# Run test and get pvalue}
\NormalTok{  coint\_test }\OtherTok{\textless{}{-}}\NormalTok{ aTSA}\SpecialCharTok{::}\FunctionTok{coint.test}\NormalTok{(y1, y2, }\AttributeTok{output =} \ConstantTok{FALSE}\NormalTok{)}
\NormalTok{  p\_value }\OtherTok{\textless{}{-}}\NormalTok{ coint\_test[}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{] }\CommentTok{\#type 1}
  
  \CommentTok{\# Again, modular(!) interpretation}
\NormalTok{  interpretation }\OtherTok{\textless{}{-}} \StringTok{""}
  \ControlFlowTok{if}\NormalTok{ (p\_value }\SpecialCharTok{\textless{}} \FloatTok{0.05}\NormalTok{) \{}
\NormalTok{    interpretation }\OtherTok{\textless{}{-}} \StringTok{"Cointegrated"}\NormalTok{\} }
  \ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    interpretation }\OtherTok{\textless{}{-}} \StringTok{"Not Cointegrated"}\NormalTok{ \}}
  
  \CommentTok{\# Export results}
  \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Variables =} \FunctionTok{paste}\NormalTok{(var\_name1, }\StringTok{"\&"}\NormalTok{, var\_name2),}
             \StringTok{\textasciigrave{}}\AttributeTok{p{-}value}\StringTok{\textasciigrave{}} \OtherTok{=}\NormalTok{ p\_value,}
             \AttributeTok{Result =}\NormalTok{ interpretation, }\AttributeTok{check.names =} \ConstantTok{FALSE}\NormalTok{) \}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}  Run Tests {-}{-}{-}{-}{-}}

\CommentTok{\# Use helper to run stationarity checks for our main variables}
\NormalTok{test\_rate }\OtherTok{\textless{}{-}} \FunctionTok{check\_stationarity}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{rate, }\StringTok{"Interest Rate"}\NormalTok{)}
\NormalTok{test\_inflation }\OtherTok{\textless{}{-}} \FunctionTok{check\_stationarity}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{inflation, }\StringTok{"Inflation"}\NormalTok{)}
\NormalTok{test\_output\_gap }\OtherTok{\textless{}{-}} \FunctionTok{check\_stationarity}\NormalTok{(}\FunctionTok{na.omit}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{output\_gap), }\StringTok{"Output Gap"}\NormalTok{)}

\CommentTok{\# Given results for rate and inflation, run tests on 1st diffs}
\NormalTok{test\_rate\_diff }\OtherTok{\textless{}{-}} \FunctionTok{check\_stationarity}\NormalTok{(}\FunctionTok{diff}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{rate), }\StringTok{"Interest Rate (1st Diff)"}\NormalTok{)}
\NormalTok{test\_inflation\_diff }\OtherTok{\textless{}{-}} \FunctionTok{check\_stationarity}\NormalTok{(}\FunctionTok{diff}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{inflation), }\StringTok{"Inflation (1st Diff)"}\NormalTok{)}

\CommentTok{\# Since rate and inflation are I(1), run a cointegration test}
\NormalTok{coint\_test }\OtherTok{=} \FunctionTok{check\_coint}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{rate, data}\SpecialCharTok{$}\NormalTok{inflation, }
            \AttributeTok{var\_name1 =} \StringTok{"Interest Rate"}\NormalTok{, }\AttributeTok{var\_name2 =} \StringTok{"Inflation"}\NormalTok{)}


\CommentTok{\# {-}{-}{-}{-}{-} Print Results {-}{-}{-}{-}{-}}

\CommentTok{\# Combine stationarity results }
\NormalTok{all\_stationarity\_results }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(test\_rate, }
\NormalTok{                                  test\_inflation, }
\NormalTok{                                  test\_output\_gap,}
\NormalTok{                                  test\_rate\_diff,}
\NormalTok{                                  test\_inflation\_diff)}

\CommentTok{\# Tables}
\NormalTok{stat\_table }\OtherTok{\textless{}{-}} \FunctionTok{kable}\NormalTok{(all\_stationarity\_results, }\AttributeTok{digits =} \DecValTok{4}\NormalTok{, }\AttributeTok{format =}\NormalTok{ format, }\AttributeTok{booktabs =} \ConstantTok{TRUE}\NormalTok{, }
      \AttributeTok{caption =} \StringTok{"Summary of Stationarity Tests (ADF }\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{\& KPSS)"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
      \FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{latex\_options =} \StringTok{"scale\_down"}\NormalTok{,}
      \AttributeTok{position =} \StringTok{"center"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
        \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{border\_right =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
        \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{4}\NormalTok{, }\AttributeTok{width =} \StringTok{"6cm"}\NormalTok{)  }
\NormalTok{stat\_table}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\caption{\label{tab:data_prop}Summary of Stationarity Tests (ADF \& KPSS)}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{tabular}[t]{>{}l|rr>{\raggedright\arraybackslash}p{6cm}}
\toprule
Variable & ADF p-value & KPSS p-value & Result\\
\midrule
Interest Rate & 0.2900 & 0.0325 & Non-Stationary I(1): ADF confirms unit root, KPSS rejects stationarity.\\
Inflation & 0.2319 & 0.1000 & Conflicting Results: ADF confirms unit root, while KPSS suggests stationarity.\\
Output Gap & 0.0144 & 0.1000 & Stationary I(0): ADF rejects unit root, KPSS confirms stationarity.\\
Interest Rate (1st Diff) & 0.0100 & 0.1000 & Stationary I(0): ADF rejects unit root, KPSS confirms stationarity.\\
Inflation (1st Diff) & 0.0100 & 0.1000 & Stationary I(0): ADF rejects unit root, KPSS confirms stationarity.\\
\bottomrule
\end{tabular}}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
  \FunctionTok{save\_kable}\NormalTok{(stat\_table, }\StringTok{"figures/staionarity\_results.tex"}\NormalTok{)\}}

\NormalTok{coint\_table }\OtherTok{\textless{}{-}} \FunctionTok{kable}\NormalTok{(coint\_test, }\AttributeTok{digits =} \DecValTok{4}\NormalTok{, }\AttributeTok{format =}\NormalTok{ format, }\AttributeTok{booktabs =} \ConstantTok{TRUE}\NormalTok{,}
      \AttributeTok{caption =} \StringTok{"Cointegration Test Results"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
      \FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{latex\_options =} \StringTok{"scale\_down"}\NormalTok{,}
      \AttributeTok{position =} \StringTok{"center"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
        \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{border\_right =} \ConstantTok{TRUE}\NormalTok{) }
\NormalTok{coint\_table}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\caption{\label{tab:data_prop}Cointegration Test Results}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{tabular}[t]{>{}l|rl}
\toprule
Variables & p-value & Result\\
\midrule
Interest Rate \& Inflation & 0.0433 & Cointegrated\\
\bottomrule
\end{tabular}}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
  \FunctionTok{save\_kable}\NormalTok{(coint\_table, }\StringTok{"figures/cointegration\_results.tex"}\NormalTok{)\}}
\end{Highlighting}
\end{Shaded}

\clearpage

\section{Taylor Rule Estimation}\label{taylor-rule-estimation}

\subsection{Without Lags}\label{without-lags}

\[
\begin{aligned}
  i_t &= \pi^* + \beta(\pi_t-\pi^*) + \gamma(y_t-\bar{y_t})  \\
\end{aligned}
\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{TR }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(rate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ realised\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap, }\AttributeTok{data =}\NormalTok{ data)}
\NormalTok{TRsr }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(shadowrate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ realised\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap, }\AttributeTok{data =}\NormalTok{ data)}

\NormalTok{table1 }\OtherTok{\textless{}{-}} \FunctionTok{export\_summs}\NormalTok{(TR, TRsr, }\AttributeTok{vcov =}\NormalTok{ sandwich}\SpecialCharTok{::}\NormalTok{NeweyWest, }
          \AttributeTok{model.names =} \FunctionTok{c}\NormalTok{(}\StringTok{"TR"}\NormalTok{, }\StringTok{"TR w/ SR"}\NormalTok{), }\AttributeTok{digits =} \DecValTok{4}\NormalTok{)}
\NormalTok{huxtable}\SpecialCharTok{::}\FunctionTok{caption}\NormalTok{(table1) }\OtherTok{\textless{}{-}} \StringTok{"No Lag, No Expectations"}
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
\NormalTok{  huxtable}\SpecialCharTok{::}\FunctionTok{quick\_latex}\NormalTok{(table1, }\AttributeTok{file =} \StringTok{"figures/TR\_no\_lag\_no\_expectations.tex"}\NormalTok{)\}}
\NormalTok{table1}
\end{Highlighting}
\end{Shaded}

 
  \providecommand{\huxb}[2]{\arrayrulecolor[RGB]{#1}\global\arrayrulewidth=#2pt}
  \providecommand{\huxvb}[2]{\color[RGB]{#1}\vrule width #2pt}
  \providecommand{\huxtpad}[1]{\rule{0pt}{#1}}
  \providecommand{\huxbpad}[1]{\rule[-#1]{0pt}{#1}}

\begin{table}[ht]
\begin{centerbox}
\begin{threeparttable}
\captionsetup{justification=centering,singlelinecheck=off}
\caption{No Lag, No Expectations}
 \label{tab:Taylor Rule simple w/o lag}
\setlength{\tabcolsep}{0pt}
\begin{tabular}{l l l}


\hhline{>{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} TR \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} TR w/ SR \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{255, 255, 255}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} (Intercept) \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.8345\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -0.8601\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.9055) \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (2.6782) \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} realised\_inflation\_gap \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.1963\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.6857\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.4289) \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.6062) \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} output\_gap \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.0824\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -0.0567\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.1628) \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.2758) \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{255, 255, 255}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} N \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 95\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 95\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} R2 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.1726\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.1159\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}-}
\arrayrulecolor{black}

\multicolumn{3}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} *** p $<$ 0.001; ** p $<$ 0.01; * p $<$ 0.05. \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}
\end{tabular}
\end{threeparttable}\par\end{centerbox}

\end{table}
 

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{TR\_e }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(rate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ exp\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap, }\AttributeTok{data =}\NormalTok{ data)}
\NormalTok{TRsr\_e }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(shadowrate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ exp\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap, }\AttributeTok{data =}\NormalTok{ data)}
\NormalTok{TR\_ie }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(rate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ realised\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ exp\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap, }\AttributeTok{data =}\NormalTok{ data)}
\NormalTok{TRsr\_ie }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(shadowrate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ realised\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ exp\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap, }\AttributeTok{data =}\NormalTok{ data)}

\NormalTok{table2 }\OtherTok{\textless{}{-}} \FunctionTok{export\_summs}\NormalTok{(TR\_e, TRsr\_e, TR\_ie, TRsr\_ie, }\AttributeTok{vcov =}\NormalTok{ sandwich}\SpecialCharTok{::}\NormalTok{NeweyWest, }
          \AttributeTok{model.names =} \FunctionTok{c}\NormalTok{(}\StringTok{"TR"}\NormalTok{, }\StringTok{"TR w/ SR"}\NormalTok{, }\StringTok{"TR"}\NormalTok{, }\StringTok{"TR w/ SR"}\NormalTok{), }\AttributeTok{digits =} \DecValTok{4}\NormalTok{)}
\NormalTok{huxtable}\SpecialCharTok{::}\FunctionTok{caption}\NormalTok{(table2) }\OtherTok{\textless{}{-}} \StringTok{"No Lag, with Inflation Expectations"}
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
\NormalTok{  huxtable}\SpecialCharTok{::}\FunctionTok{quick\_latex}\NormalTok{(table2, }\AttributeTok{file =} \StringTok{"figures/TR\_no\_lag\_w\_expectations.tex"}\NormalTok{)\}}
\NormalTok{table2}
\end{Highlighting}
\end{Shaded}

 
  \providecommand{\huxb}[2]{\arrayrulecolor[RGB]{#1}\global\arrayrulewidth=#2pt}
  \providecommand{\huxvb}[2]{\color[RGB]{#1}\vrule width #2pt}
  \providecommand{\huxtpad}[1]{\rule{0pt}{#1}}
  \providecommand{\huxbpad}[1]{\rule[-#1]{0pt}{#1}}

\begin{table}[ht]
\begin{centerbox}
\begin{threeparttable}
\captionsetup{justification=centering,singlelinecheck=off}
\caption{No Lag, with Inflation Expectations}
 \label{tab:Taylor Rule simple w/o lag but with inflatione expectations}
\setlength{\tabcolsep}{0pt}
\begin{tabular}{l l l l l}


\hhline{>{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} TR \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} TR w/ SR \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} TR \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} TR w/ SR \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{255, 255, 255}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} (Intercept) \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 1.3440 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.2867\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 1.3381 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.1715\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.3179)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (1.5603)\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.3714)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (1.5918)\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} exp\_inflation\_gap \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 1.7238 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 3.7581 ** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 1.7107 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 3.5044 ** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.3523)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (1.3756)\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.3466)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (1.1674)\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} output\_gap \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.0707\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -0.0026\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.0662\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -0.0898\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0468)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.1871)\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0810)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.2133)\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} realised\_inflation\_gap \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.0163\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.3171\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.1277)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.3433)\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{255, 255, 255}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} N \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 95\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 95\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 95\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 95\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} R2 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.6177\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.3904\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.6180\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.4086\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}-}
\arrayrulecolor{black}

\multicolumn{5}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} *** p $<$ 0.001; ** p $<$ 0.01; * p $<$ 0.05. \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}
\end{tabular}
\end{threeparttable}\par\end{centerbox}

\end{table}
 

\subsection{Lagged Models}\label{lagged-models}

\[
\begin{aligned}
     i_t &= \pi^* + \phi i_{t-1} + \beta (\pi_t-\pi^*) + \gamma(y_t-\bar{y_t}) 
\end{aligned}
\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lTR }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(rate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ rate\_lag }\SpecialCharTok{+}\NormalTok{ realised\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap, }\AttributeTok{data =}\NormalTok{ data)}
\NormalTok{lTRsr }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(shadowrate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ shadowrate\_lag }\SpecialCharTok{+}\NormalTok{ realised\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap, }\AttributeTok{data =}\NormalTok{ data)}

\NormalTok{table3 }\OtherTok{\textless{}{-}} \FunctionTok{export\_summs}\NormalTok{(lTR, lTRsr, }\AttributeTok{vcov =}\NormalTok{ sandwich}\SpecialCharTok{::}\NormalTok{NeweyWest, }
          \AttributeTok{model.names =} \FunctionTok{c}\NormalTok{(}\StringTok{"TR"}\NormalTok{, }\StringTok{"TR w/ SR"}\NormalTok{), }\AttributeTok{digits =} \DecValTok{4}\NormalTok{)}
\NormalTok{huxtable}\SpecialCharTok{::}\FunctionTok{caption}\NormalTok{(table3) }\OtherTok{\textless{}{-}} \StringTok{"Interest Rate Lag, No Expectations"}
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
\NormalTok{  huxtable}\SpecialCharTok{::}\FunctionTok{quick\_latex}\NormalTok{(table3, }\AttributeTok{file =} \StringTok{"figures/TR\_w\_lag\_no\_expectations.tex"}\NormalTok{)\}}
\NormalTok{table3}
\end{Highlighting}
\end{Shaded}

 
  \providecommand{\huxb}[2]{\arrayrulecolor[RGB]{#1}\global\arrayrulewidth=#2pt}
  \providecommand{\huxvb}[2]{\color[RGB]{#1}\vrule width #2pt}
  \providecommand{\huxtpad}[1]{\rule{0pt}{#1}}
  \providecommand{\huxbpad}[1]{\rule[-#1]{0pt}{#1}}

\begin{table}[ht]
\begin{centerbox}
\begin{threeparttable}
\captionsetup{justification=centering,singlelinecheck=off}
\caption{Interest Rate Lag, No Expectations}
 \label{tab:Taylor Rule simple w/ lag}
\setlength{\tabcolsep}{0pt}
\begin{tabular}{l l l}


\hhline{>{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} TR \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} TR w/ SR \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{255, 255, 255}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} (Intercept) \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.0507\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -0.0777\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0410)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0618)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} rate\_lag \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.9189 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0390)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} realised\_inflation\_gap \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.0879 *\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.2498 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0350)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0344)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} output\_gap \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.0218\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -0.0116\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0163)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0185)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} shadowrate\_lag \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.9530 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0176)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{255, 255, 255}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} N \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 95\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 95\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} R2 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.9594\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.9828\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}-}
\arrayrulecolor{black}

\multicolumn{3}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} *** p $<$ 0.001; ** p $<$ 0.01; * p $<$ 0.05. \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}
\end{tabular}
\end{threeparttable}\par\end{centerbox}

\end{table}
 

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lTR\_e }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(rate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ rate\_lag }\SpecialCharTok{+}\NormalTok{ exp\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap, }\AttributeTok{data =}\NormalTok{ data)}
\NormalTok{lTRsr\_e }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(shadowrate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ shadowrate\_lag }\SpecialCharTok{+}\NormalTok{ exp\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap, }\AttributeTok{data =}\NormalTok{ data)}
\NormalTok{lTR\_ie }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(rate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ rate\_lag }\SpecialCharTok{+}\NormalTok{ realised\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ exp\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap, }\AttributeTok{data =}\NormalTok{ data)}
\NormalTok{lTRsr\_ie }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(shadowrate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ shadowrate\_lag }\SpecialCharTok{+}\NormalTok{ realised\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ exp\_inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap, }\AttributeTok{data =}\NormalTok{ data) }

\NormalTok{table4 }\OtherTok{\textless{}{-}} \FunctionTok{export\_summs}\NormalTok{(lTR\_e, lTRsr\_e, lTR\_ie,lTRsr\_ie, }\AttributeTok{vcov =}\NormalTok{ sandwich}\SpecialCharTok{::}\NormalTok{NeweyWest, }
          \AttributeTok{model.names =} \FunctionTok{c}\NormalTok{(}\StringTok{"TR"}\NormalTok{, }\StringTok{"TR w/ SR"}\NormalTok{, }\StringTok{"TR"}\NormalTok{, }\StringTok{"TR w/ SR"}\NormalTok{), }\AttributeTok{digits =} \DecValTok{4}\NormalTok{)}
\NormalTok{huxtable}\SpecialCharTok{::}\FunctionTok{caption}\NormalTok{(table4) }\OtherTok{\textless{}{-}} \StringTok{"Interest Rate Lag, with Inflation Expectations"}
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
\NormalTok{  huxtable}\SpecialCharTok{::}\FunctionTok{quick\_latex}\NormalTok{(table4, }\AttributeTok{file =} \StringTok{"figures/TR\_w\_lag\_w\_expectations.tex"}\NormalTok{)\}}
\NormalTok{table4}
\end{Highlighting}
\end{Shaded}

 
  \providecommand{\huxb}[2]{\arrayrulecolor[RGB]{#1}\global\arrayrulewidth=#2pt}
  \providecommand{\huxvb}[2]{\color[RGB]{#1}\vrule width #2pt}
  \providecommand{\huxtpad}[1]{\rule{0pt}{#1}}
  \providecommand{\huxbpad}[1]{\rule[-#1]{0pt}{#1}}

\begin{table}[ht]
\begin{centerbox}
\begin{threeparttable}
\captionsetup{justification=centering,singlelinecheck=off}
\caption{Interest Rate Lag, with Inflation Expectations}
 \label{tab:Taylor Rule simple w/ lag and inflation expectations}
\setlength{\tabcolsep}{0pt}
\begin{tabular}{l l l l l}


\hhline{>{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} TR \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} TR w/ SR \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} TR \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} TR w/ SR \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{255, 255, 255}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} (Intercept) \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.1804 *\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.0009\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.1341 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -0.0896\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0796)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0869)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0378)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0622)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} rate\_lag \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.8606 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.8742 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0438)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0392)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} exp\_inflation\_gap \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.2387 **\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.1296\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.1536 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -0.0546\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0733)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.1039)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0435)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0622)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} output\_gap \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.0449 *\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.0592\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.0233\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -0.0108\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0218)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0474)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0165)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0182)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} shadowrate\_lag \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.9630 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.9581 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0287)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0190)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} realised\_inflation\_gap \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.0770 *\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.2532 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0378)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.0347)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{255, 255, 255}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} N \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 95\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 95\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 95\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 95\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} R2 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.9544\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.9712\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.9611\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.9828\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}-}
\arrayrulecolor{black}

\multicolumn{5}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} *** p $<$ 0.001; ** p $<$ 0.01; * p $<$ 0.05. \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}
\end{tabular}
\end{threeparttable}\par\end{centerbox}

\end{table}
 

\subsection{Checking for structural
breaks}\label{checking-for-structural-breaks}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Formula to test for breaks}
\NormalTok{break\_formula }\OtherTok{=}\NormalTok{ rate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ rate\_lag }\SpecialCharTok{+}\NormalTok{ inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap}

\CommentTok{\# Suspected break: Start of ZLB in 2012 Q3}
\NormalTok{breakpoint1\_obs }\OtherTok{=} \DecValTok{55} \CommentTok{\#R = 55 in evaluation chunk}
\NormalTok{breakpoint1\_date }\OtherTok{\textless{}{-}}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{quarter[breakpoint1\_obs]}

\CommentTok{\# Suspected break: Covid}
\NormalTok{breakpoint2\_obs }\OtherTok{=} \DecValTok{85} \CommentTok{\#R = 85 in evaluation chunk}
\NormalTok{breakpoint2\_date }\OtherTok{\textless{}{-}}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{quarter[breakpoint2\_obs]}

\CommentTok{\# Chow test (rejecting the null means there are structural breaks)}
\NormalTok{chow\_test1 }\OtherTok{\textless{}{-}} \FunctionTok{sctest}\NormalTok{(break\_formula, }\AttributeTok{type =} \StringTok{"Chow"}\NormalTok{, }\AttributeTok{point =}\NormalTok{ breakpoint1\_obs, }\AttributeTok{data =}\NormalTok{ data)}
\NormalTok{chow\_test2 }\OtherTok{\textless{}{-}} \FunctionTok{sctest}\NormalTok{(break\_formula, }\AttributeTok{type =} \StringTok{"Chow"}\NormalTok{, }\AttributeTok{point =}\NormalTok{ breakpoint2\_obs, }\AttributeTok{data =}\NormalTok{ data)}

\CommentTok{\# Table with Chow results (for suspected breaks)}
\NormalTok{chow\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{Event =} \FunctionTok{c}\NormalTok{(}\StringTok{"ZLB Start"}\NormalTok{, }\StringTok{"COVID{-}19 Start"}\NormalTok{),}
  \AttributeTok{Date =} \FunctionTok{c}\NormalTok{(}\FunctionTok{as.character}\NormalTok{(breakpoint1\_date), }\FunctionTok{as.character}\NormalTok{(breakpoint2\_date)),}
  \StringTok{\textasciigrave{}}\AttributeTok{p{-}value}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{c}\NormalTok{(chow\_test1}\SpecialCharTok{$}\NormalTok{p.value, chow\_test2}\SpecialCharTok{$}\NormalTok{p.value),}\AttributeTok{check.names =} \ConstantTok{FALSE}\NormalTok{)}

\NormalTok{chow\_table }\OtherTok{\textless{}{-}} \FunctionTok{kable}\NormalTok{(chow\_df, }\AttributeTok{digits =} \DecValTok{4}\NormalTok{, }\AttributeTok{format =}\NormalTok{ format, }\AttributeTok{booktabs =} \ConstantTok{TRUE}\NormalTok{,}
      \AttributeTok{caption =} \StringTok{"Chow tests for suspected structural breaks"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
      \FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{latex\_options =} \StringTok{"scale\_down"}\NormalTok{,}
      \AttributeTok{position =} \StringTok{"center"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
        \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{border\_right =} \ConstantTok{TRUE}\NormalTok{) }
\NormalTok{chow\_table}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\caption{\label{tab:chowtest}Chow tests for suspected structural breaks}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{tabular}[t]{>{}l|lr}
\toprule
Event & Date & p-value\\
\midrule
ZLB Start & 2012 Q3 & 0.0020\\
COVID-19 Start & 2020 Q1 & 0.0365\\
\bottomrule
\end{tabular}}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
  \FunctionTok{save\_kable}\NormalTok{(chow\_table, }\StringTok{"figures/chow\_breaks.tex"}\NormalTok{)\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Estimate Bai{-}Perron test \& output results}
\NormalTok{BP\_test }\OtherTok{=} \FunctionTok{breakpoints}\NormalTok{(break\_formula, }\AttributeTok{data =}\NormalTok{ data)}
\NormalTok{BP\_test\_res }\OtherTok{=} \FunctionTok{summary}\NormalTok{(BP\_test)}

\CommentTok{\# Optimal values (modular!)}
\NormalTok{bic\_values }\OtherTok{\textless{}{-}}\NormalTok{ BP\_test\_res}\SpecialCharTok{$}\NormalTok{RSS[}\DecValTok{2}\NormalTok{, ]}
\NormalTok{optimal\_m }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{names}\NormalTok{(bic\_values)[}\FunctionTok{which.min}\NormalTok{(bic\_values)])}

\CommentTok{\# Make a table out of results (also modular!)}
\ControlFlowTok{if}\NormalTok{ (optimal\_m }\SpecialCharTok{==} \DecValTok{0}\NormalTok{) \{}
\NormalTok{  bp\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
    \StringTok{\textasciigrave{}}\AttributeTok{Detected Breaks}\StringTok{\textasciigrave{}} \OtherTok{=} \StringTok{"No structural breaks detected"}\NormalTok{,}
    \AttributeTok{check.names =} \ConstantTok{FALSE}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{  break\_obs }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(BP\_test\_res}\SpecialCharTok{$}\NormalTok{breakpoints[optimal\_m, ])}
\NormalTok{  detected\_dates }\OtherTok{\textless{}{-}}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{quarter[break\_obs]}
\NormalTok{  bp\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
    \StringTok{\textasciigrave{}}\AttributeTok{Detected Breaks}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{as.character}\NormalTok{(detected\_dates),}
    \AttributeTok{check.names =} \ConstantTok{FALSE}\NormalTok{) \}}

\NormalTok{bp\_table }\OtherTok{\textless{}{-}} \FunctionTok{kable}\NormalTok{(bp\_df, }\AttributeTok{format =}\NormalTok{ format, }\AttributeTok{booktabs=}\ConstantTok{TRUE}\NormalTok{,}
  \AttributeTok{caption =} \StringTok{"Bai{-}Perron test for multiple breaks"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{latex\_options =} \StringTok{"scale\_down"}\NormalTok{,}
      \AttributeTok{position =} \StringTok{"center"}\NormalTok{) }
\NormalTok{bp\_table}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\caption{\label{tab:bai-perron test}Bai-Perron test for multiple breaks}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{tabular}[t]{l}
\toprule
Detected Breaks\\
\midrule
2006 Q2\\
2019 Q1\\
\bottomrule
\end{tabular}}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
  \FunctionTok{save\_kable}\NormalTok{(bp\_table, }\StringTok{"figures/bp\_breaks.tex"}\NormalTok{)\}}
\CommentTok{\# Note: breaks\_obs shows in which row the BP breaks are }
\end{Highlighting}
\end{Shaded}

\subsection{Rolling Estimation (for structural
breaks)}\label{rolling-estimation-for-structural-breaks}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# This function automatically plots the output from the rolling estimation loop}
\NormalTok{plot\_rolling\_coefs }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(data, var\_name, }\AttributeTok{var\_name\_title=}\NormalTok{var\_name) \{}
  
  \CommentTok{\# 1. Dynamically create the column names for CIs}
\NormalTok{  lower\_col }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(var\_name, }\StringTok{"\_lower"}\NormalTok{)}
\NormalTok{  upper\_col }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(var\_name, }\StringTok{"\_upper"}\NormalTok{)}

  \CommentTok{\# 2. Create the plot, using .data[[]] to find the}
  \CommentTok{\#     columns based on the variable names (modularity)}
\NormalTok{  plot }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ date)) }\SpecialCharTok{+}
    \CommentTok{\# Add a dashed line at y=0 for reference}
    \FunctionTok{geom\_hline}\NormalTok{(}\AttributeTok{yintercept =} \DecValTok{0}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey40"}\NormalTok{, }\AttributeTok{linewidth =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
    \CommentTok{\# Add 95\% confidence interval ribbon}
    \FunctionTok{geom\_ribbon}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{ymin =}\NormalTok{ .data[[lower\_col]], }\AttributeTok{ymax =}\NormalTok{ .data[[upper\_col]]),}
                \AttributeTok{fill =} \StringTok{"dodgerblue"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
    \CommentTok{\# Add the coefficient estimate line}
    \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ .data[[var\_name]]), }
              \AttributeTok{color =} \StringTok{"dodgerblue4"}\NormalTok{, }\AttributeTok{linewidth =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
     \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Rolling Coefficient Estimate:"}\NormalTok{, var\_name\_title),}
        \AttributeTok{subtitle =} \StringTok{"with 95\% confidence interval"}\NormalTok{,}
      \AttributeTok{x =} \StringTok{""}\NormalTok{,}
      \AttributeTok{y =} \StringTok{"Coefficient Value"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{5}\NormalTok{)),}
          \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey30"}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{10}\NormalTok{)),}
          \AttributeTok{axis.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
          \AttributeTok{axis.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{))}
  \ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
  \FunctionTok{ggsave}\NormalTok{(}\AttributeTok{filename =} \FunctionTok{paste0}\NormalTok{(}\StringTok{"roll\_coef\_"}\NormalTok{,var\_name\_title, }\StringTok{".png"}\NormalTok{), }\AttributeTok{path =} \StringTok{"figures/"}\NormalTok{, }\AttributeTok{plot=}\NormalTok{plot)\}}
      \FunctionTok{return}\NormalTok{(plot) \}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set rolling window (in quarters) \& Looping Parameter}
\NormalTok{W }\OtherTok{=} \DecValTok{30}
\NormalTok{L }\OtherTok{=} \FunctionTok{nrow}\NormalTok{(data) }\SpecialCharTok{{-}}\NormalTok{ W }\SpecialCharTok{+} \DecValTok{1}
\NormalTok{formula }\OtherTok{=}\NormalTok{ rate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ rate\_lag }\SpecialCharTok{+}\NormalTok{ inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap}

\CommentTok{\# Preparation of result data, dates, var names, and confidence intervals}
\NormalTok{var\_names }\OtherTok{\textless{}{-}} \FunctionTok{attr}\NormalTok{(}\FunctionTok{terms}\NormalTok{(formula), }\StringTok{"term.labels"}\NormalTok{)}
\NormalTok{window\_end\_dates }\OtherTok{\textless{}{-}}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{quarter[W}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(data)] }\CommentTok{\# First window [1:W] ends at data$date[W]}
\NormalTok{TR\_roll }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{date =}\NormalTok{ window\_end\_dates)}
\NormalTok{TR\_roll[var\_names] }\OtherTok{\textless{}{-}} \ConstantTok{NA}
\NormalTok{lower\_col\_names }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(var\_names, }\StringTok{"\_lower"}\NormalTok{)}
\NormalTok{upper\_col\_names }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(var\_names, }\StringTok{"\_upper"}\NormalTok{)}

\CommentTok{\# Looped estimation of TR, outputs coefficients and CIs}
\ControlFlowTok{for}\NormalTok{ (l }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{L) \{}
  \CommentTok{\# 1. Define splits (with rolling scheme)}
\NormalTok{  rolled\_data }\OtherTok{\textless{}{-}}\NormalTok{ data[l}\SpecialCharTok{:}\NormalTok{(W }\SpecialCharTok{+}\NormalTok{ l }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{), ]}
  
  \CommentTok{\# 2. Estimate TR on split data, using whatever formula is desired}
\NormalTok{  TR\_estimate }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(formula, }\AttributeTok{data =}\NormalTok{ rolled\_data)}

  \CommentTok{\# 3. Pull out coefficients \& compute confidence intervals}
\NormalTok{  all\_coefs }\OtherTok{\textless{}{-}} \FunctionTok{coef}\NormalTok{(TR\_estimate)}
\NormalTok{  all\_cis }\OtherTok{\textless{}{-}} \FunctionTok{confint}\NormalTok{(TR\_estimate)}
  
\NormalTok{  TR\_roll[l, var\_names] }\OtherTok{\textless{}{-}}\NormalTok{ all\_coefs[var\_names] }
\NormalTok{  TR\_roll[l, lower\_col\_names] }\OtherTok{\textless{}{-}}\NormalTok{ all\_cis[var\_names, }\DecValTok{1}\NormalTok{]}
\NormalTok{  TR\_roll[l, upper\_col\_names] }\OtherTok{\textless{}{-}}\NormalTok{ all\_cis[var\_names, }\DecValTok{2}\NormalTok{]   \}}

\CommentTok{\# Plotting (note: this part is not modular, obviously)}
\FunctionTok{plot\_rolling\_coefs}\NormalTok{(TR\_roll, }\StringTok{"rate\_lag"}\NormalTok{, }\AttributeTok{var\_name\_title=}\StringTok{"Rate Lag"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{ECB-Project_files/figure-latex/rolling TR-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot\_rolling\_coefs}\NormalTok{(TR\_roll, }\StringTok{"inflation\_gap"}\NormalTok{, }\AttributeTok{var\_name\_title=}\StringTok{"Inflation (Gap)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{ECB-Project_files/figure-latex/rolling TR-2.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot\_rolling\_coefs}\NormalTok{(TR\_roll, }\StringTok{"output\_gap"}\NormalTok{, }\AttributeTok{var\_name\_title=}\StringTok{"Output Gap"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{ECB-Project_files/figure-latex/rolling TR-3.pdf}}

\clearpage

\section{Forecasting Model
Evaluation}\label{forecasting-model-evaluation}

\subsection{Helpers}\label{helpers}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# Helper function for adding p{-}value significance stars}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}

\NormalTok{  format\_p\_values\_with\_stars }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(p) \{}
\NormalTok{    stars }\OtherTok{\textless{}{-}} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{      p }\SpecialCharTok{\textless{}} \FloatTok{0.01} \SpecialCharTok{\textasciitilde{}} \StringTok{"***"}\NormalTok{,}
\NormalTok{      p }\SpecialCharTok{\textless{}} \FloatTok{0.05} \SpecialCharTok{\textasciitilde{}} \StringTok{"**"}\NormalTok{,}
\NormalTok{      p }\SpecialCharTok{\textless{}} \FloatTok{0.10} \SpecialCharTok{\textasciitilde{}} \StringTok{"*"}\NormalTok{,}
      \ConstantTok{TRUE}     \SpecialCharTok{\textasciitilde{}} \StringTok{""}\NormalTok{)}
    \FunctionTok{paste0}\NormalTok{(}\FunctionTok{format}\NormalTok{(}\FunctionTok{round}\NormalTok{(p, }\DecValTok{4}\NormalTok{), }\AttributeTok{nsmall =} \DecValTok{3}\NormalTok{), }\StringTok{" "}\NormalTok{, stars)\}}

\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# HELPER FUNCTION FOR MINCER{-}ZARNOWITZ REPORTING}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# This function runs the Mincer{-}Zarnowitz regression (Actuals \textasciitilde{} Forecasts)}
\CommentTok{\# for each horizon h and tests the joint null hypothesis H0: (alpha, beta) = (0, 1).}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}

\NormalTok{generate\_mincer\_zarnowitz\_report }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(F\_model, }
\NormalTok{                                             Actual\_values, }
\NormalTok{                                             H, }
\NormalTok{                                             model\_caption, }
                                             \AttributeTok{format =} \StringTok{"html"}\NormalTok{) \{}
  \CommentTok{\# Pre{-}allocate storage for results}
\NormalTok{  mz\_results }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
    \AttributeTok{Horizon =} \DecValTok{1}\SpecialCharTok{:}\NormalTok{H,}
    \AttributeTok{Alpha =} \FunctionTok{numeric}\NormalTok{(H),}
    \AttributeTok{Beta =} \FunctionTok{numeric}\NormalTok{(H),}
    \AttributeTok{P\_Value\_Joint\_Test =} \FunctionTok{numeric}\NormalTok{(H))}
  
  \ControlFlowTok{for}\NormalTok{ (h }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{H) \{}
    \CommentTok{\# 1. Create a clean data frame for this horizon}
    \CommentTok{\#    This pairs the forecasts and actual values and removes any NAs,}
    \CommentTok{\#    ensuring they remain perfectly aligned.}
\NormalTok{    df\_h }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
      \AttributeTok{actuals =}\NormalTok{ Actual\_values[[h]],}
      \AttributeTok{forecasts =}\NormalTok{ F\_model[[h]] ) }\SpecialCharTok{\%\textgreater{}\%}
      \FunctionTok{na.omit}\NormalTok{() }
    
    \CommentTok{\# Check if we have enough data to run the regression (at least 2 obs)}
    \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{nrow}\NormalTok{(df\_h) }\SpecialCharTok{\textgreater{}} \DecValTok{2}\NormalTok{) \{}
      \CommentTok{\# 2. Run MZ regression}
\NormalTok{      mz\_reg }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(actuals }\SpecialCharTok{\textasciitilde{}}\NormalTok{ forecasts, }\AttributeTok{data =}\NormalTok{ df\_h)}
      
      \CommentTok{\# 3. Get coefficients}
\NormalTok{      coeffs }\OtherTok{\textless{}{-}} \FunctionTok{summary}\NormalTok{(mz\_reg)}\SpecialCharTok{$}\NormalTok{coefficients}
\NormalTok{      mz\_results}\SpecialCharTok{$}\NormalTok{Alpha[h] }\OtherTok{\textless{}{-}}\NormalTok{ coeffs[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{] }
\NormalTok{      mz\_results}\SpecialCharTok{$}\NormalTok{Beta[h]  }\OtherTok{\textless{}{-}}\NormalTok{ coeffs[}\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{] }
      
      \CommentTok{\# Using NW errors as seen in class, with lag selection h{-}1}
\NormalTok{      v\_matrix }\OtherTok{\textless{}{-}}
        \ControlFlowTok{if}\NormalTok{ (h }\SpecialCharTok{==} \DecValTok{1}\NormalTok{) \{}
          \CommentTok{\# h=1: No autocorrelation, use standard "White" (HC) errors}
\NormalTok{          sandwich}\SpecialCharTok{::}\FunctionTok{vcovHC}\NormalTok{(mz\_reg, }\AttributeTok{type =} \StringTok{"HC3"}\NormalTok{)}
\NormalTok{        \} }\ControlFlowTok{else}\NormalTok{ \{}
          \CommentTok{\# h\textgreater{}1: Use Newey{-}West, manually setting lag = h{-}1}
\NormalTok{          sandwich}\SpecialCharTok{::}\FunctionTok{NeweyWest}\NormalTok{(mz\_reg, }\AttributeTok{lag =}\NormalTok{ h }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)\}}
      
      \CommentTok{\# 4. Test Joint Hypothesis H0: Alpha = 0 AND Beta = 1 and store pvalues}
\NormalTok{      test\_joint }\OtherTok{\textless{}{-}} \FunctionTok{linearHypothesis}\NormalTok{(mz\_reg,}
                       \FunctionTok{c}\NormalTok{(}\StringTok{"(Intercept) = 0"}\NormalTok{, }\StringTok{"forecasts = 1"}\NormalTok{), }\AttributeTok{vcov. =}\NormalTok{ v\_matrix)}
\NormalTok{      mz\_results}\SpecialCharTok{$}\NormalTok{P\_Value\_Joint\_Test[h] }\OtherTok{\textless{}{-}}\NormalTok{ test\_joint}\SpecialCharTok{$}\StringTok{"Pr(\textgreater{}F)"}\NormalTok{[}\DecValTok{2}\NormalTok{]}

\NormalTok{    \} }\ControlFlowTok{else}\NormalTok{ \{}
      \CommentTok{\# Not enough data to run regression for this horizon}
\NormalTok{      mz\_results}\SpecialCharTok{$}\NormalTok{Alpha[h] }\OtherTok{\textless{}{-}} \ConstantTok{NA\_real\_}
\NormalTok{      mz\_results}\SpecialCharTok{$}\NormalTok{Beta[h]  }\OtherTok{\textless{}{-}} \ConstantTok{NA\_real\_}
\NormalTok{      mz\_results}\SpecialCharTok{$}\NormalTok{P\_Value\_Joint\_Test[h] }\OtherTok{\textless{}{-}} \ConstantTok{NA\_real\_}\NormalTok{ \} \}}
  
  \CommentTok{\# Format the results for the table}
\NormalTok{  mz\_results }\OtherTok{\textless{}{-}}\NormalTok{ mz\_results }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Alpha =} \FunctionTok{round}\NormalTok{(Alpha, }\DecValTok{4}\NormalTok{),}
           \AttributeTok{Beta =} \FunctionTok{round}\NormalTok{(Beta, }\DecValTok{4}\NormalTok{),}
           \AttributeTok{P\_Value\_Joint\_Test =} \FunctionTok{format\_p\_values\_with\_stars}\NormalTok{(P\_Value\_Joint\_Test))}
    
  \CommentTok{\# Create the table}
\NormalTok{  table\_output }\OtherTok{\textless{}{-}} \FunctionTok{kable}\NormalTok{(}
\NormalTok{    mz\_results,}
    \AttributeTok{format =}\NormalTok{ format,}
    \AttributeTok{booktabs =} \ConstantTok{TRUE}\NormalTok{,}
    \AttributeTok{caption =}\NormalTok{ model\_caption,}
    \AttributeTok{digits =} \DecValTok{4}\NormalTok{,}
    \AttributeTok{col.names =} \FunctionTok{c}\NormalTok{(}\StringTok{"h"}\NormalTok{, }\StringTok{"Alpha"}\NormalTok{, }\StringTok{"Beta"}\NormalTok{, }\StringTok{"pv(Joint)"}\NormalTok{),}
    \AttributeTok{escape =} \ConstantTok{FALSE}\NormalTok{ ) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{kable\_styling}\NormalTok{(}
      \AttributeTok{latex\_options =} \FunctionTok{c}\NormalTok{(}\StringTok{"striped"}\NormalTok{, }\StringTok{"scale\_down"}\NormalTok{),}
      \AttributeTok{position =} \StringTok{"center"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{bold =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{border\_right =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{4}\NormalTok{, }\AttributeTok{monospace =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{footnote}\NormalTok{(}
      \AttributeTok{general =} \StringTok{"pv(Joint) is the p{-}value for the joint hypothesis H\_0: (Alpha, Beta) = (0, 1). A high p{-}value means we fail to reject the null hypothesis of an unbiased, efficient forecast."}\NormalTok{,}
      \AttributeTok{symbol =} \FunctionTok{c}\NormalTok{(}
        \StringTok{"Signif. codes:  \textquotesingle{}***\textquotesingle{} 0.01,  \textquotesingle{}**\textquotesingle{} 0.05,  \textquotesingle{}*\textquotesingle{} 0.1"}\NormalTok{),}
      \AttributeTok{general\_title =} \StringTok{"Note:"}\NormalTok{,}
      \AttributeTok{symbol\_title =} \StringTok{""}\NormalTok{,}
      \AttributeTok{footnote\_as\_chunk =} \ConstantTok{TRUE}\NormalTok{,}
      \AttributeTok{threeparttable =} \ConstantTok{TRUE}\NormalTok{)}
  \ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
\NormalTok{    safe\_name }\OtherTok{\textless{}{-}} \FunctionTok{gsub}\NormalTok{(}\StringTok{"[\^{}a{-}zA{-}Z0{-}9]"}\NormalTok{, }\StringTok{"\_"}\NormalTok{, model\_caption)}
\NormalTok{    safe\_name }\OtherTok{\textless{}{-}} \FunctionTok{gsub}\NormalTok{(}\StringTok{"\_+"}\NormalTok{, }\StringTok{"\_"}\NormalTok{, safe\_name)}
\NormalTok{    safe\_name }\OtherTok{\textless{}{-}} \FunctionTok{substr}\NormalTok{(safe\_name, }\DecValTok{1}\NormalTok{, }\DecValTok{50}\NormalTok{)}
\NormalTok{    safe\_name }\OtherTok{\textless{}{-}} \FunctionTok{gsub}\NormalTok{(}\StringTok{"\_$"}\NormalTok{, }\StringTok{""}\NormalTok{, safe\_name)}
    \FunctionTok{save\_kable}\NormalTok{(table\_output, }\FunctionTok{paste0}\NormalTok{(}\StringTok{"figures/"}\NormalTok{, safe\_name, }\StringTok{".tex"}\NormalTok{))\}}
  \FunctionTok{return}\NormalTok{(table\_output) \}}



\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# HELPER FUNCTION FOR REPORTING DM tests}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}

\CommentTok{\# This function creates the DM tests and kable output}
\NormalTok{generate\_report\_table }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(FE\_TR\_model, FE\_BM\_model, H, model\_caption, }\AttributeTok{format =} \StringTok{"html"}\NormalTok{) \{ MSFE\_TR }\OtherTok{=} \FunctionTok{numeric}\NormalTok{(H)}
\NormalTok{  MSFE\_BM }\OtherTok{=} \FunctionTok{numeric}\NormalTok{(H)}
  
  \CommentTok{\# Calculate MSFEs}
  \ControlFlowTok{for}\NormalTok{ (h }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{H) \{}
    \CommentTok{\# Ensure errors are cleaned of NAs}
\NormalTok{    fe1 }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(FE\_TR\_model[[h]])}
\NormalTok{    fe2 }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(FE\_BM\_model[[h]])}
    
\NormalTok{    MSFE\_TR[h] }\OtherTok{=} \FunctionTok{mean}\NormalTok{((fe1)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{    MSFE\_BM[h] }\OtherTok{=} \FunctionTok{mean}\NormalTok{((fe2)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)\}}
  
  \CommentTok{\# Run DM Tests}
\NormalTok{  DMpvalues }\OtherTok{=} \FunctionTok{matrix}\NormalTok{(, }\AttributeTok{nrow =}\NormalTok{ H, }\AttributeTok{ncol =} \DecValTok{3}\NormalTok{)}
  \FunctionTok{colnames}\NormalTok{(DMpvalues) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"DM\_Two\_Sided"}\NormalTok{, }\StringTok{"DM\_Greater"}\NormalTok{, }\StringTok{"DM\_Lesser"}\NormalTok{)}
  \ControlFlowTok{for}\NormalTok{ (h }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{H)\{}
    \CommentTok{\# Note: dm.test needs the *full* (un{-}omitted) error vectors}
    \CommentTok{\# to align them properly, hence using the original list inputs}
\NormalTok{    x1 }\OtherTok{=} \FunctionTok{dm.test}\NormalTok{(}\AttributeTok{e1 =}\NormalTok{ FE\_BM\_model[[h]], }\AttributeTok{e2 =}\NormalTok{ FE\_TR\_model[[h]], }\AttributeTok{h =}\NormalTok{ h)}
\NormalTok{    x2 }\OtherTok{=} \FunctionTok{dm.test}\NormalTok{(}\AttributeTok{e1 =}\NormalTok{ FE\_BM\_model[[h]], }\AttributeTok{e2 =}\NormalTok{ FE\_TR\_model[[h]], }\AttributeTok{h =}\NormalTok{ h, }\AttributeTok{alternative =} \StringTok{"greater"}\NormalTok{)}
\NormalTok{    x3 }\OtherTok{=} \FunctionTok{dm.test}\NormalTok{(}\AttributeTok{e1 =}\NormalTok{ FE\_BM\_model[[h]], }\AttributeTok{e2 =}\NormalTok{ FE\_TR\_model[[h]], }\AttributeTok{h =}\NormalTok{ h, }\AttributeTok{alternative =} \StringTok{"less"}\NormalTok{)}
\NormalTok{    DMpvalues[h, }\DecValTok{1}\NormalTok{] }\OtherTok{=} \FunctionTok{round}\NormalTok{(x1}\SpecialCharTok{$}\NormalTok{p.value, }\AttributeTok{digits =} \DecValTok{4}\NormalTok{)}
\NormalTok{    DMpvalues[h, }\DecValTok{2}\NormalTok{] }\OtherTok{=} \FunctionTok{round}\NormalTok{(x2}\SpecialCharTok{$}\NormalTok{p.value, }\AttributeTok{digits =} \DecValTok{4}\NormalTok{)}
\NormalTok{    DMpvalues[h, }\DecValTok{3}\NormalTok{] }\OtherTok{=} \FunctionTok{round}\NormalTok{(x3}\SpecialCharTok{$}\NormalTok{p.value, }\AttributeTok{digits =} \DecValTok{4}\NormalTok{)\}}

  \CommentTok{\# Create final table data}
\NormalTok{  forecast\_comparison }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
    \AttributeTok{Horizon =} \DecValTok{1}\SpecialCharTok{:}\NormalTok{H,}
    \AttributeTok{MSFE\_TR =}\NormalTok{ MSFE\_TR,}
    \AttributeTok{MSFE\_BM =}\NormalTok{ MSFE\_BM) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Ratio\_TR\_vs\_BM =}\NormalTok{ MSFE\_TR }\SpecialCharTok{/}\NormalTok{ MSFE\_BM)}
  
\NormalTok{  forecast\_comparison }\OtherTok{\textless{}{-}} \FunctionTok{bind\_cols}\NormalTok{(forecast\_comparison, }\FunctionTok{as.data.frame}\NormalTok{(DMpvalues))}
  
\NormalTok{  final\_data\_formatted }\OtherTok{\textless{}{-}}\NormalTok{ forecast\_comparison }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{mutate}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"DM\_"}\NormalTok{), format\_p\_values\_with\_stars))}
  
  \CommentTok{\# Create the kable table}
\NormalTok{  table\_output }\OtherTok{\textless{}{-}} \FunctionTok{kable}\NormalTok{(}
\NormalTok{    final\_data\_formatted,}
    \AttributeTok{format =}\NormalTok{ format,}
    \AttributeTok{booktabs =} \ConstantTok{TRUE}\NormalTok{,}
    \AttributeTok{caption =}\NormalTok{ model\_caption,}
    \AttributeTok{digits =} \DecValTok{4}\NormalTok{,}
    \AttributeTok{col.names =} \FunctionTok{c}\NormalTok{(}\StringTok{"h"}\NormalTok{, }\StringTok{"MSFE TR"}\NormalTok{, }\StringTok{"MSFE BM"}\NormalTok{, }\StringTok{"Ratio"}\NormalTok{, }\StringTok{"DM Two{-}Sided"}\NormalTok{, }\StringTok{"DM Greater"}\NormalTok{, }\StringTok{"DM Lesser"}\NormalTok{),}
    \AttributeTok{escape =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{kable\_styling}\NormalTok{(}
      \AttributeTok{latex\_options =} \FunctionTok{c}\NormalTok{(}\StringTok{"striped"}\NormalTok{, }\StringTok{"scale\_down"}\NormalTok{),}
      \AttributeTok{position =} \StringTok{"center"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{bold =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{border\_right =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{5}\SpecialCharTok{:}\DecValTok{7}\NormalTok{, }\AttributeTok{monospace =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{footnote}\NormalTok{(}
      \AttributeTok{general =} \StringTok{"TR refers to the forecast made with an estimated Taylor Rule. BM refers to a benchmark of the interest rate using an ARIMA model. Ratio \textless{} 1 indicates that the TR model has lower MSFE."}\NormalTok{,}
      \AttributeTok{symbol =} \FunctionTok{c}\NormalTok{(}
        \StringTok{"\textquotesingle{}DM Greater\textquotesingle{} tests if the TR model is significantly more accurate than the BM model."}\NormalTok{,}
        \StringTok{"\textquotesingle{}DM Lesser\textquotesingle{} tests if the TR model is significantly less accurate than the BM model."}\NormalTok{),}
      \AttributeTok{general\_title =} \StringTok{"Note:"}\NormalTok{,}
      \AttributeTok{symbol\_title =} \StringTok{"DM Test Alternative Hypotheses (H\_A):"}\NormalTok{,}
      \AttributeTok{footnote\_as\_chunk =} \ConstantTok{TRUE}\NormalTok{,}
      \AttributeTok{threeparttable =} \ConstantTok{TRUE}\NormalTok{) }
  \ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
\NormalTok{    safe\_name }\OtherTok{\textless{}{-}} \FunctionTok{gsub}\NormalTok{(}\StringTok{"[\^{}a{-}zA{-}Z0{-}9]"}\NormalTok{, }\StringTok{"\_"}\NormalTok{, model\_caption)}
\NormalTok{    safe\_name }\OtherTok{\textless{}{-}} \FunctionTok{gsub}\NormalTok{(}\StringTok{"\_+"}\NormalTok{, }\StringTok{"\_"}\NormalTok{, safe\_name)}
\NormalTok{    safe\_name }\OtherTok{\textless{}{-}} \FunctionTok{substr}\NormalTok{(safe\_name, }\DecValTok{1}\NormalTok{, }\DecValTok{50}\NormalTok{)}
\NormalTok{    safe\_name }\OtherTok{\textless{}{-}} \FunctionTok{gsub}\NormalTok{(}\StringTok{"\_$"}\NormalTok{, }\StringTok{""}\NormalTok{, safe\_name)}
    \FunctionTok{save\_kable}\NormalTok{(table\_output, }\FunctionTok{paste0}\NormalTok{(}\StringTok{"figures/"}\NormalTok{, safe\_name, }\StringTok{".tex"}\NormalTok{))\}}
  \FunctionTok{return}\NormalTok{(table\_output)\}}
\end{Highlighting}
\end{Shaded}

\subsection{Estimation}\label{estimation}

Pseudo-out of sample recursive estimation scheme of direct forecasts for
all Taylor Rule formulas and a benchmark ARIMA specification.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#parameters}
\NormalTok{R }\OtherTok{=} \DecValTok{85} \CommentTok{\# Chow: Structural breaks at R=55 and R=85 }
\FunctionTok{cat}\NormalTok{(}\StringTok{"Evaluation sample starts after "}\NormalTok{,}\FunctionTok{as.character}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{quarter[R]),}\StringTok{"."}\NormalTok{,}\AttributeTok{sep=}\StringTok{""}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Evaluation sample starts after 2020 Q1.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{P }\OtherTok{=} \FunctionTok{nrow}\NormalTok{(data) }\SpecialCharTok{{-}}\NormalTok{ R }\CommentTok{\#but will effectively be: P = T{-}h{-}R}
\NormalTok{H }\OtherTok{=} \DecValTok{10} \CommentTok{\#number of different horizons (takes 10 to go until 2027 Q4)}

\CommentTok{\#note: we are doing a recursive estimation scheme for out{-}of{-}sample tests}
\CommentTok{\#note: we are doing direct forecasts }

\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# 1. DEFINE THE TAYLOR RULE (TR) MODEL FORMULAS}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}

\CommentTok{\# TR specifications (using either current inflation or inflation expectations}
\CommentTok{\#                    according to configuration, same with HP vs Hamilton)}
\NormalTok{formula\_1 }\OtherTok{\textless{}{-}}\NormalTok{ rate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap}
\NormalTok{formula\_2 }\OtherTok{\textless{}{-}}\NormalTok{ shadowrate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap}
\NormalTok{formula\_3 }\OtherTok{\textless{}{-}}\NormalTok{ rate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ rate\_lag }\SpecialCharTok{+}\NormalTok{ inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap}
\NormalTok{formula\_4 }\OtherTok{\textless{}{-}}\NormalTok{ shadowrate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ shadowrate\_lag }\SpecialCharTok{+}\NormalTok{ inflation\_gap }\SpecialCharTok{+}\NormalTok{ output\_gap}

\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# 2. PRE{-}ALLOCATE STORAGE FOR ALL RESULTS}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}

\CommentTok{\# We need 4 lists for the TR models, 1 list for the shared benchmark}
\NormalTok{init\_storage\_list }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(H, P) \{}
\NormalTok{  storage }\OtherTok{\textless{}{-}} \FunctionTok{vector}\NormalTok{(}\StringTok{"list"}\NormalTok{, }\AttributeTok{length =}\NormalTok{ H)}
  \ControlFlowTok{for}\NormalTok{ (h }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{H) \{}
\NormalTok{    storage[[h]] }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\ConstantTok{NA\_real\_}\NormalTok{, P)\}}
  \FunctionTok{return}\NormalTok{(storage)\}}

\CommentTok{\# Storage for realised values }
\NormalTok{Actuals }\OtherTok{\textless{}{-}} \FunctionTok{init\_storage\_list}\NormalTok{(H, P)}

\CommentTok{\# Storage for Forecasts }
\NormalTok{F\_TR\_1 }\OtherTok{\textless{}{-}} \FunctionTok{init\_storage\_list}\NormalTok{(H, P) }\CommentTok{\# Model 1: shadowrate, no lag}
\NormalTok{F\_TR\_2 }\OtherTok{\textless{}{-}} \FunctionTok{init\_storage\_list}\NormalTok{(H, P) }\CommentTok{\# Model 2: rate, no lag}
\NormalTok{F\_TR\_3 }\OtherTok{\textless{}{-}} \FunctionTok{init\_storage\_list}\NormalTok{(H, P) }\CommentTok{\# Model 3: shadowrate, with lag}
\NormalTok{F\_TR\_4 }\OtherTok{\textless{}{-}} \FunctionTok{init\_storage\_list}\NormalTok{(H, P) }\CommentTok{\# Model 4: rate, with lag}
\NormalTok{F\_BM   }\OtherTok{\textless{}{-}} \FunctionTok{init\_storage\_list}\NormalTok{(H, P) }\CommentTok{\# Benchmark: ARIMA}

\CommentTok{\# Storage for Forecast Errors }
\NormalTok{FE\_TR\_1 }\OtherTok{\textless{}{-}} \FunctionTok{init\_storage\_list}\NormalTok{(H, P) }\CommentTok{\# Model 1: shadowrate, no lag}
\NormalTok{FE\_TR\_2 }\OtherTok{\textless{}{-}} \FunctionTok{init\_storage\_list}\NormalTok{(H, P) }\CommentTok{\# Model 2: rate, no lag}
\NormalTok{FE\_TR\_3 }\OtherTok{\textless{}{-}} \FunctionTok{init\_storage\_list}\NormalTok{(H, P) }\CommentTok{\# Model 3: shadowrate, with lag}
\NormalTok{FE\_TR\_4 }\OtherTok{\textless{}{-}} \FunctionTok{init\_storage\_list}\NormalTok{(H, P) }\CommentTok{\# Model 4: rate, with lag}
\NormalTok{FE\_BM   }\OtherTok{\textless{}{-}} \FunctionTok{init\_storage\_list}\NormalTok{(H, P) }\CommentTok{\# Benchmark: ARIMA}


\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# 3. SETUP \& RUN THE PARALLEL BACKTESTING LOOP}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{num\_cores }\OtherTok{\textless{}{-}} \FunctionTok{detectCores}\NormalTok{() }\SpecialCharTok{{-}} \DecValTok{1} 
\NormalTok{cl }\OtherTok{\textless{}{-}} \FunctionTok{makeCluster}\NormalTok{(num\_cores)}
\FunctionTok{registerDoParallel}\NormalTok{(cl)}

\CommentTok{\# .export sends read{-}only objects to each core}
\CommentTok{\# .packages loads libraries on each core}
\NormalTok{worker\_results }\OtherTok{\textless{}{-}} \FunctionTok{foreach}\NormalTok{(}
  \AttributeTok{p =}\NormalTok{ P}\SpecialCharTok{:}\DecValTok{1}\NormalTok{, }
  \AttributeTok{.packages =} \FunctionTok{c}\NormalTok{(}\StringTok{"forecast"}\NormalTok{, }\StringTok{"stats"}\NormalTok{, }\StringTok{"dplyr"}\NormalTok{),}
  \AttributeTok{.export =} \FunctionTok{c}\NormalTok{(}\StringTok{"data"}\NormalTok{, }\StringTok{"H"}\NormalTok{, }\StringTok{"formula\_1"}\NormalTok{, }\StringTok{"formula\_2"}\NormalTok{, }\StringTok{"formula\_3"}\NormalTok{, }\StringTok{"formula\_4"}\NormalTok{)}
\NormalTok{) }\SpecialCharTok{\%dopar\%}\NormalTok{ \{}
  
  \CommentTok{\# 1. Define splits (with rolling scheme)}
\NormalTok{  training }\OtherTok{\textless{}{-}}\NormalTok{ data[(}\DecValTok{1} \SpecialCharTok{+} \FunctionTok{nrow}\NormalTok{(data) }\SpecialCharTok{{-}}\NormalTok{ R }\SpecialCharTok{{-}}\NormalTok{ p)}\SpecialCharTok{:}\NormalTok{(}\FunctionTok{nrow}\NormalTok{(data) }\SpecialCharTok{{-}}\NormalTok{ p), ]}
\NormalTok{  testing }\OtherTok{\textless{}{-}}\NormalTok{ data[(}\FunctionTok{nrow}\NormalTok{(data) }\SpecialCharTok{{-}}\NormalTok{ (p }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{))}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(data), ]}
  
  \CommentTok{\# {-}{-}{-} 2. Fit common models only once {-}{-}{-} }
  \CommentTok{\# note: d=1 for interest and inflation as non{-}stationary}
\NormalTok{  inflation\_arma }\OtherTok{\textless{}{-}} \FunctionTok{my.auto.arima}\NormalTok{(training}\SpecialCharTok{$}\NormalTok{inflation\_gap, }\AttributeTok{max.p=}\DecValTok{4}\NormalTok{, }\AttributeTok{max.q=}\DecValTok{4}\NormalTok{, }\AttributeTok{d=}\DecValTok{1}\NormalTok{)}
\NormalTok{  outputgap\_arma }\OtherTok{\textless{}{-}} \FunctionTok{my.auto.arima}\NormalTok{(training}\SpecialCharTok{$}\NormalTok{output\_gap, }\AttributeTok{max.p=}\DecValTok{4}\NormalTok{, }\AttributeTok{max.q=}\DecValTok{4}\NormalTok{, }\AttributeTok{d=}\DecValTok{0}\NormalTok{)}
\NormalTok{  interest\_arma }\OtherTok{\textless{}{-}} \FunctionTok{my.auto.arima}\NormalTok{(training}\SpecialCharTok{$}\NormalTok{rate, }\AttributeTok{max.p=}\DecValTok{4}\NormalTok{, }\AttributeTok{max.q=}\DecValTok{4}\NormalTok{, }\AttributeTok{d=}\DecValTok{1}\NormalTok{) }\CommentTok{\# Benchmark}
  
  \CommentTok{\# {-}{-}{-} 3. Get common forecasts only once (all H horizons) {-}{-}{-}}
\NormalTok{  inflation\_forecasts }\OtherTok{\textless{}{-}} \FunctionTok{my.forecast}\NormalTok{(inflation\_arma, }\AttributeTok{h =}\NormalTok{ H)}
\NormalTok{  outputgap\_forecasts }\OtherTok{\textless{}{-}} \FunctionTok{my.forecast}\NormalTok{(outputgap\_arma, }\AttributeTok{h =}\NormalTok{ H)}
\NormalTok{  BMpredicted\_rates }\OtherTok{\textless{}{-}} \FunctionTok{my.forecast}\NormalTok{(interest\_arma, }\AttributeTok{h =}\NormalTok{ H)}
  
  \CommentTok{\# {-}{-}{-} 4. Fit the 4 TR models {-}{-}{-}}
\NormalTok{  TR\_model\_1 }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(formula\_1, }\AttributeTok{data =}\NormalTok{ training)}
\NormalTok{  TR\_model\_2 }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(formula\_2, }\AttributeTok{data =}\NormalTok{ training)}
\NormalTok{  TR\_model\_3 }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(formula\_3, }\AttributeTok{data =}\NormalTok{ training)}
\NormalTok{  TR\_model\_4 }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(formula\_4, }\AttributeTok{data =}\NormalTok{ training)}
  
  \CommentTok{\# {-}{-}{-} 5. Build forecast input data \& get forecasts for non{-}lagged models {-}{-}{-}}
  \CommentTok{\# These are direct forecasts}
\NormalTok{  new\_data\_base }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
    \AttributeTok{inflation\_gap =}\NormalTok{ inflation\_forecasts,}
    \AttributeTok{output\_gap =}\NormalTok{ outputgap\_forecasts)}
    
\NormalTok{  TR\_preds\_1 }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(}\FunctionTok{pmax}\NormalTok{(}\FunctionTok{predict}\NormalTok{(TR\_model\_1, new\_data\_base), }\FunctionTok{min}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{rate)) }\SpecialCharTok{/} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{*} \FloatTok{0.25}
\NormalTok{  TR\_preds\_2 }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(}\FunctionTok{pmax}\NormalTok{(}\FunctionTok{predict}\NormalTok{(TR\_model\_2, new\_data\_base), }\FunctionTok{min}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{rate)) }\SpecialCharTok{/} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{*} \FloatTok{0.25}
\NormalTok{  BM\_preds }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(}\FunctionTok{pmax}\NormalTok{(BMpredicted\_rates, }\FunctionTok{min}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{rate)) }\SpecialCharTok{/} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{*} \FloatTok{0.25}
  
  \CommentTok{\# {-}{-}{-} 6. Get forecasts for lagged models via iteration {-}{-}{-}}
  \CommentTok{\# We must loop 1 step at a time, feeding forecasts back in.   }
  
  \CommentTok{\# a) Pre{-}allocate storage for H forecasts}
\NormalTok{  TR\_preds\_3 }\OtherTok{\textless{}{-}} \FunctionTok{numeric}\NormalTok{(H)}
\NormalTok{  TR\_preds\_4 }\OtherTok{\textless{}{-}} \FunctionTok{numeric}\NormalTok{(H)}
  
  \CommentTok{\# b) Get the last known lag from the training set (lag for h=1 forecast)}
\NormalTok{  current\_rate\_lag  }\OtherTok{\textless{}{-}} \FunctionTok{last}\NormalTok{(training}\SpecialCharTok{$}\NormalTok{rate)}
\NormalTok{  current\_shadowrate\_lag }\OtherTok{\textless{}{-}} \FunctionTok{last}\NormalTok{(training}\SpecialCharTok{$}\NormalTok{shadowrate)}

  \CommentTok{\# Loop for iterative forecasting }
  \ControlFlowTok{for}\NormalTok{ (h }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{H) \{}
    \CommentTok{\# {-}{-}{-} Prepare dataset for predictions {-}{-}{-}}
\NormalTok{    new\_data\_3\_h }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
      \AttributeTok{inflation\_gap =}\NormalTok{ inflation\_forecasts[h],}
      \AttributeTok{output\_gap =}\NormalTok{ outputgap\_forecasts[h],}
      \AttributeTok{rate\_lag =}\NormalTok{ current\_rate\_lag)}
\NormalTok{    new\_data\_4\_h }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
      \AttributeTok{inflation\_gap =}\NormalTok{ inflation\_forecasts[h],}
      \AttributeTok{output\_gap =}\NormalTok{ outputgap\_forecasts[h],}
      \AttributeTok{shadowrate\_lag =}\NormalTok{ current\_shadowrate\_lag )}
    
    \CommentTok{\# Get the forecast values (keep for lag, and then round for actual prediction)}
\NormalTok{    pred\_3\_h }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(TR\_model\_3, new\_data\_3\_h)}
\NormalTok{    TR\_preds\_3[h] }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(}\FunctionTok{pmax}\NormalTok{(pred\_3\_h, }\FunctionTok{min}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{rate)) }\SpecialCharTok{/} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{*} \FloatTok{0.25}
\NormalTok{    pred\_4\_h }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(TR\_model\_4, new\_data\_4\_h)}
\NormalTok{    TR\_preds\_4[h] }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(}\FunctionTok{pmax}\NormalTok{(pred\_4\_h, }\FunctionTok{min}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{rate)) }\SpecialCharTok{/} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{*} \FloatTok{0.25}
    
    \CommentTok{\# Update lag for h+1 }
\NormalTok{    current\_shadowrate\_lag }\OtherTok{\textless{}{-}}\NormalTok{ pred\_4\_h}
\NormalTok{    current\_rate\_lag }\OtherTok{\textless{}{-}}\NormalTok{ pred\_3\_h \}}

  \CommentTok{\# {-}{-}{-} 7. Get actual values in evaluation sample  {-}{-}{-}}
\NormalTok{  actual\_rates }\OtherTok{\textless{}{-}}\NormalTok{ testing}\SpecialCharTok{$}\NormalTok{rate[}\DecValTok{1}\SpecialCharTok{:}\NormalTok{H]}
  
  \CommentTok{\# {-}{-}{-} 8. Return all FORECASTS and ACTUALS from the worker {-}{-}{-}}
  \FunctionTok{list}\NormalTok{(}\AttributeTok{F\_TR\_FORMULA\_1 =}\NormalTok{ TR\_preds\_1,}
       \AttributeTok{F\_TR\_FORMULA\_2 =}\NormalTok{ TR\_preds\_2,}
       \AttributeTok{F\_TR\_FORMULA\_3 =}\NormalTok{ TR\_preds\_3,}
       \AttributeTok{F\_TR\_FORMULA\_4 =}\NormalTok{ TR\_preds\_4,}
       \AttributeTok{F\_BM  =}\NormalTok{ BM\_preds,}
       \AttributeTok{actuals =}\NormalTok{ actual\_rates) \}}
    
\CommentTok{\# {-}{-}{-} Stop the Cluster {-}{-}{-}}
\FunctionTok{stopCluster}\NormalTok{(cl)}
\FunctionTok{rm}\NormalTok{(cl)}

\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# 4. UNPACK PARALLEL RESULTS INTO STORAGE LISTS}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}

\CommentTok{\# \textquotesingle{}worker\_results\textquotesingle{} is a list of P lists. We need to re{-}organize it.}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{P) \{}
  \CommentTok{\# i=1 corresponds to p=P, i=2 to p=P{-}1, ... i=P to p=1}
  \CommentTok{\# This \textquotesingle{}storage\_index\textquotesingle{} matches the loop order}
\NormalTok{  storage\_index }\OtherTok{\textless{}{-}}\NormalTok{ i }
\NormalTok{  p\_results }\OtherTok{\textless{}{-}}\NormalTok{ worker\_results[[i]]}
  
  \ControlFlowTok{for}\NormalTok{ (h }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{H) \{}
    \CommentTok{\# Get the raw values for this h}
\NormalTok{    actual\_val }\OtherTok{\textless{}{-}}\NormalTok{ p\_results}\SpecialCharTok{$}\NormalTok{actuals[h]}
\NormalTok{    f\_tr1\_val  }\OtherTok{\textless{}{-}}\NormalTok{ p\_results}\SpecialCharTok{$}\NormalTok{F\_TR\_FORMULA\_1[h]}
\NormalTok{    f\_tr2\_val  }\OtherTok{\textless{}{-}}\NormalTok{ p\_results}\SpecialCharTok{$}\NormalTok{F\_TR\_FORMULA\_2[h]}
\NormalTok{    f\_tr3\_val  }\OtherTok{\textless{}{-}}\NormalTok{ p\_results}\SpecialCharTok{$}\NormalTok{F\_TR\_FORMULA\_3[h]}
\NormalTok{    f\_tr4\_val  }\OtherTok{\textless{}{-}}\NormalTok{ p\_results}\SpecialCharTok{$}\NormalTok{F\_TR\_FORMULA\_4[h]}
\NormalTok{    f\_bm\_val   }\OtherTok{\textless{}{-}}\NormalTok{ p\_results}\SpecialCharTok{$}\NormalTok{F\_BM[h]}
    
    \CommentTok{\# Store Actuals (for MZ)}
\NormalTok{    Actuals[[h]][storage\_index] }\OtherTok{\textless{}{-}}\NormalTok{ actual\_val}
    
    \CommentTok{\# Store Forecasts (for MZ)}
\NormalTok{    F\_TR\_1[[h]][storage\_index] }\OtherTok{\textless{}{-}}\NormalTok{ f\_tr1\_val}
\NormalTok{    F\_TR\_2[[h]][storage\_index] }\OtherTok{\textless{}{-}}\NormalTok{ f\_tr2\_val}
\NormalTok{    F\_TR\_3[[h]][storage\_index] }\OtherTok{\textless{}{-}}\NormalTok{ f\_tr3\_val}
\NormalTok{    F\_TR\_4[[h]][storage\_index] }\OtherTok{\textless{}{-}}\NormalTok{ f\_tr4\_val}
\NormalTok{    F\_BM[[h]][storage\_index]   }\OtherTok{\textless{}{-}}\NormalTok{ f\_bm\_val}
    
    \CommentTok{\# Calculate and Store Errors (for MSFE/DM)}
\NormalTok{    FE\_TR\_1[[h]][storage\_index] }\OtherTok{\textless{}{-}}\NormalTok{ f\_tr1\_val }\SpecialCharTok{{-}}\NormalTok{ actual\_val}
\NormalTok{    FE\_TR\_2[[h]][storage\_index] }\OtherTok{\textless{}{-}}\NormalTok{ f\_tr2\_val }\SpecialCharTok{{-}}\NormalTok{ actual\_val}
\NormalTok{    FE\_TR\_3[[h]][storage\_index] }\OtherTok{\textless{}{-}}\NormalTok{ f\_tr3\_val }\SpecialCharTok{{-}}\NormalTok{ actual\_val}
\NormalTok{    FE\_TR\_4[[h]][storage\_index] }\OtherTok{\textless{}{-}}\NormalTok{ f\_tr4\_val }\SpecialCharTok{{-}}\NormalTok{ actual\_val}
\NormalTok{    FE\_BM[[h]][storage\_index]   }\OtherTok{\textless{}{-}}\NormalTok{ f\_bm\_val  }\SpecialCharTok{{-}}\NormalTok{ actual\_val \} \}}

\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# 5. RENDER RESULTS MORE INTUITIVE FOR FURTHER ANALYSIS}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}

\CommentTok{\# Convert the forecast lists (F\_TR\_x) into single dataframes}
\NormalTok{forecast\_to\_df }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(forecast\_list, period) \{}
  \CommentTok{\# Convert each element to numeric (benchmark is ts object, which is bad)}
\NormalTok{  numeric\_list }\OtherTok{\textless{}{-}} \FunctionTok{lapply}\NormalTok{(forecast\_list, }\ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{as.numeric}\NormalTok{(x)) }\CommentTok{\#just make each list inside numeric}
\NormalTok{  df }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(numeric\_list)}
  \CommentTok{\# Add period and horizon}
\NormalTok{  df}\SpecialCharTok{$}\NormalTok{period }\OtherTok{\textless{}{-}}\NormalTok{ period }\CommentTok{\#first list is all horizon 1 forecasts, gives this to all observations}
\NormalTok{  df}\SpecialCharTok{$}\NormalTok{horizon }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(df) }\CommentTok{\#counts rows and gives each the horizon corresponding to it}
\NormalTok{  df\}}

\CommentTok{\# Apply to all forecasting models}
\NormalTok{eval\_all\_models }\OtherTok{\textless{}{-}} \FunctionTok{do.call}\NormalTok{(rbind, }\FunctionTok{lapply}\NormalTok{(}\FunctionTok{seq\_along}\NormalTok{(worker\_results), }\ControlFlowTok{function}\NormalTok{(i) \{}
  \FunctionTok{forecast\_to\_df}\NormalTok{(worker\_results[[i]], }\AttributeTok{period =}\NormalTok{ i) \}))}
\NormalTok{eval\_all\_models[] }\OtherTok{\textless{}{-}} \FunctionTok{lapply}\NormalTok{(eval\_all\_models, }\ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{as.numeric}\NormalTok{(x))}
\end{Highlighting}
\end{Shaded}

\subsection{Spaghetti Plots}\label{spaghetti-plots}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Select the model to plot based on initial option}
\ControlFlowTok{if}\NormalTok{ (USE\_FORMULA }\SpecialCharTok{==} \StringTok{"Formula 1"}\NormalTok{) \{}
\NormalTok{  model }\OtherTok{\textless{}{-}} \StringTok{"F\_TR\_FORMULA\_1"}
\NormalTok{  model\_formula }\OtherTok{\textless{}{-}}\NormalTok{ formula\_1}
\NormalTok{  model\_name }\OtherTok{\textless{}{-}} \StringTok{"Taylor Rule Formula 1"}
\NormalTok{\} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (USE\_FORMULA }\SpecialCharTok{==} \StringTok{"Formula 2"}\NormalTok{) \{}
\NormalTok{  model }\OtherTok{\textless{}{-}} \StringTok{"F\_TR\_FORMULA\_2"}
\NormalTok{  model\_formula }\OtherTok{\textless{}{-}}\NormalTok{ formula\_2}
\NormalTok{  model\_name }\OtherTok{\textless{}{-}} \StringTok{"Taylor Rule Formula 2"}
\NormalTok{\} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (USE\_FORMULA }\SpecialCharTok{==} \StringTok{"Formula 3"}\NormalTok{) \{}
\NormalTok{  model }\OtherTok{\textless{}{-}} \StringTok{"F\_TR\_FORMULA\_3"}
\NormalTok{  model\_formula }\OtherTok{\textless{}{-}}\NormalTok{ formula\_3}
\NormalTok{  model\_name }\OtherTok{\textless{}{-}} \StringTok{"Taylor Rule Formula 3"}
\NormalTok{\} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (USE\_FORMULA }\SpecialCharTok{==} \StringTok{"Formula 4"}\NormalTok{) \{}
\NormalTok{  model }\OtherTok{\textless{}{-}} \StringTok{"F\_TR\_FORMULA\_4"}
\NormalTok{  model\_formula }\OtherTok{\textless{}{-}}\NormalTok{ formula\_4}
\NormalTok{  model\_name }\OtherTok{\textless{}{-}} \StringTok{"Taylor Rule Formula 4"}\NormalTok{ \}}

\CommentTok{\# period = date the forecast was made}
\CommentTok{\# date\_of\_forecast = the future date we are predicting}
\NormalTok{eval\_all\_models}\SpecialCharTok{$}\NormalTok{date\_of\_forecast }\OtherTok{\textless{}{-}}\NormalTok{ eval\_all\_models}\SpecialCharTok{$}\NormalTok{period }\SpecialCharTok{+}\NormalTok{ eval\_all\_models}\SpecialCharTok{$}\NormalTok{horizon }

\CommentTok{\# Spaghetti plot with color per period}
\NormalTok{spag\_plot1 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(eval\_all\_models, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ date\_of\_forecast, }\AttributeTok{y =}\NormalTok{ .data[[model]], }\AttributeTok{group =}\NormalTok{ period, }\AttributeTok{color =} \FunctionTok{factor}\NormalTok{(period))) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}    \CommentTok{\# forecast lines}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{shape =} \DecValTok{2}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\# Actuals as black baseline}
  \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ actuals), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ actuals), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{shape =} \DecValTok{4}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Evaluation Sample Forecasts vs Realised Values"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Period"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Interest Rate"}\NormalTok{,}
       \AttributeTok{color =} \StringTok{"Forecast Origin"}\NormalTok{,}
    \AttributeTok{subtitle =} \FunctionTok{paste}\NormalTok{(}\StringTok{"For model based on:"}\NormalTok{, model\_name)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{5}\NormalTok{)),}
      \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey30"}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{10}\NormalTok{)),}
      \AttributeTok{axis.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
      \AttributeTok{axis.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{))}
\NormalTok{spag\_plot1}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{ECB-Project_files/figure-latex/Spaghetti Plot-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
  \FunctionTok{ggsave}\NormalTok{(}\AttributeTok{filename =} \StringTok{"spaghetti\_plot.png"}\NormalTok{, }\AttributeTok{path =} \StringTok{"figures/"}\NormalTok{, }\AttributeTok{plot=}\NormalTok{spag\_plot1)\}}
\end{Highlighting}
\end{Shaded}

\subsection{Forecast Errors}\label{forecast-errors}

\subsubsection{Plots of FE}\label{plots-of-fe}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Compute forecast error}
\NormalTok{eval\_all\_models}\SpecialCharTok{$}\NormalTok{forecast\_error }\OtherTok{\textless{}{-}}\NormalTok{ eval\_all\_models[[model]] }\SpecialCharTok{{-}}\NormalTok{ eval\_all\_models}\SpecialCharTok{$}\NormalTok{actuals}

\CommentTok{\#compute date\_of\_forecast for x{-}axis}
\NormalTok{eval\_all\_models}\SpecialCharTok{$}\NormalTok{date\_of\_forecast }\OtherTok{\textless{}{-}}\NormalTok{ eval\_all\_models}\SpecialCharTok{$}\NormalTok{period }\SpecialCharTok{+}\NormalTok{ eval\_all\_models}\SpecialCharTok{$}\NormalTok{horizon}

\NormalTok{spag\_plot2 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(eval\_all\_models, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ date\_of\_forecast, }\AttributeTok{group =}\NormalTok{ period)) }\SpecialCharTok{+}
  \CommentTok{\# Forecast error lines}
  \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ forecast\_error), }\AttributeTok{color =} \StringTok{"blue"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ forecast\_error), }\AttributeTok{color =} \StringTok{"blue"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{shape =} \DecValTok{4}\NormalTok{) }\SpecialCharTok{+}
  
  \CommentTok{\# Actual rates line}
  \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ actuals), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ actuals), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{shape =} \DecValTok{4}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Evaluation Sample Forecast Errors"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Below Zero = forecast was too low ; Above Zero = forecast too high"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Interest Rate and Forecast Error (deviation from interest rate)"}\NormalTok{,}
    \AttributeTok{subtitle =} \FunctionTok{paste}\NormalTok{(}\StringTok{"For model based on:"}\NormalTok{, model\_name))  }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{5}\NormalTok{)),}
      \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey30"}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{10}\NormalTok{)),}
      \AttributeTok{axis.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
      \AttributeTok{axis.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{))}
\NormalTok{spag\_plot2}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{ECB-Project_files/figure-latex/Plot of Forecast Errors-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
  \FunctionTok{ggsave}\NormalTok{(}\AttributeTok{filename =} \StringTok{"spaghetti\_errors\_plot.png"}\NormalTok{, }\AttributeTok{path =} \StringTok{"figures/"}\NormalTok{, }\AttributeTok{plot=}\NormalTok{spag\_plot2)\}}
\end{Highlighting}
\end{Shaded}

\subsubsection{Density of FE}\label{density-of-fe}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Version 1: Non{-}Adjusted Scales}
\NormalTok{plot\_facet1 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(eval\_all\_models }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(horizon }\SpecialCharTok{\textless{}=}\NormalTok{ H), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ forecast\_error)) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{fill =} \StringTok{"\#3498db"}\NormalTok{, }\AttributeTok{color =} \StringTok{"\#2980b9"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.6}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{horizon, }\AttributeTok{ncol =} \DecValTok{4}\NormalTok{, }\AttributeTok{labeller =}\NormalTok{ label\_both, }\AttributeTok{scales =} \StringTok{"free"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Density of Forecast Errors by Horizon (Non{-}Adjusted Scale)"}\NormalTok{,}
       \AttributeTok{subtitle =} \FunctionTok{paste}\NormalTok{(}\StringTok{"For model based on:"}\NormalTok{, model\_name),}
       \AttributeTok{x =} \StringTok{"Forecast Error"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Density"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{5}\NormalTok{)),}
        \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey30"}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{10}\NormalTok{)),}
        \AttributeTok{axis.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
        \AttributeTok{axis.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{),}
        \AttributeTok{strip.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill =} \StringTok{"\#ecf0f1"}\NormalTok{, }\AttributeTok{color =} \ConstantTok{NA}\NormalTok{), }
        \AttributeTok{strip.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{))}
\FunctionTok{print}\NormalTok{(plot\_facet1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 45 rows containing non-finite outside the scale range
## (`stat_density()`).
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{ECB-Project_files/figure-latex/Density of Forecast Errors-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
  \FunctionTok{ggsave}\NormalTok{(}\AttributeTok{filename =} \StringTok{"density\_plot.png"}\NormalTok{, }\AttributeTok{path =} \StringTok{"figures/"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ plot\_facet1)\}}

\CommentTok{\# Version 2: Adjusted scales}
\NormalTok{plot\_facet2 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(eval\_all\_models }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(horizon }\SpecialCharTok{\textless{}=}\NormalTok{ H), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ forecast\_error)) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{fill =} \StringTok{"\#3498db"}\NormalTok{, }\AttributeTok{color =} \StringTok{"\#2980b9"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.6}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{horizon, }\AttributeTok{ncol =} \DecValTok{4}\NormalTok{, }\AttributeTok{labeller =}\NormalTok{ label\_both) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Density of Forecast Errors by Horizon (Adjusted Scale)"}\NormalTok{,}
       \AttributeTok{subtitle =} \FunctionTok{paste}\NormalTok{(}\StringTok{"For model based on:"}\NormalTok{, model\_name),}
       \AttributeTok{x =} \StringTok{"Forecast Error"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Density"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{5}\NormalTok{)),}
        \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey30"}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{10}\NormalTok{)),}
        \AttributeTok{axis.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
        \AttributeTok{axis.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{),}
        \AttributeTok{strip.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill =} \StringTok{"\#ecf0f1"}\NormalTok{, }\AttributeTok{color =} \ConstantTok{NA}\NormalTok{), }
        \AttributeTok{strip.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{))}
\FunctionTok{print}\NormalTok{(plot\_facet2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 45 rows containing non-finite outside the scale range
## (`stat_density()`).
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{ECB-Project_files/figure-latex/Density of Forecast Errors-2.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
  \FunctionTok{ggsave}\NormalTok{(}\AttributeTok{filename =} \StringTok{"density\_scaled\_plot.png"}\NormalTok{, }\AttributeTok{path =} \StringTok{"figures/"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ plot\_facet2)\}}

\CommentTok{\# Version 3: "Ridges"}
\NormalTok{plot\_ridge }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(eval\_all\_models }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(horizon }\SpecialCharTok{\textless{}=}\NormalTok{ H),}
                       \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ forecast\_error, }\AttributeTok{y =} \FunctionTok{as.factor}\NormalTok{(horizon), }\AttributeTok{fill =} \FunctionTok{stat}\NormalTok{(x))) }\SpecialCharTok{+}
    \FunctionTok{geom\_density\_ridges\_gradient}\NormalTok{(}\AttributeTok{scale =} \DecValTok{3}\NormalTok{, }\AttributeTok{rel\_min\_height =} \FloatTok{0.01}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_fill\_viridis\_c}\NormalTok{(}\AttributeTok{name =} \StringTok{"Error"}\NormalTok{, }\AttributeTok{option =} \StringTok{"C"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Density of Forecast Errors by Horizon"}\NormalTok{,}
         \AttributeTok{subtitle =} \FunctionTok{paste}\NormalTok{(}\StringTok{"For model based on:"}\NormalTok{, model\_name),}
         \AttributeTok{x =} \StringTok{"Forecast Error"}\NormalTok{,}
         \AttributeTok{y =} \StringTok{"Forecast Horizon"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{5}\NormalTok{)),}
      \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey30"}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{10}\NormalTok{)),}
      \AttributeTok{axis.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
      \AttributeTok{axis.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{))}
\FunctionTok{print}\NormalTok{(plot\_ridge)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: `stat(x)` was deprecated in ggplot2 3.4.0.
## i Please use `after_stat(x)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
\end{verbatim}

\begin{verbatim}
## Picking joint bandwidth of 0.664
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{ECB-Project_files/figure-latex/Density of Forecast Errors-3.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
  \FunctionTok{ggsave}\NormalTok{(}\AttributeTok{filename =} \StringTok{"densityridge\_plot.png"}\NormalTok{, }\AttributeTok{path =} \StringTok{"figures/"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ plot\_ridge)\}}
\end{Highlighting}
\end{Shaded}

\subsubsection{Variance of FE}\label{variance-of-fe}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# This gives us the mean forecast error for the h step ahead forecast}
\NormalTok{var\_by\_horizon }\OtherTok{\textless{}{-}}\NormalTok{ eval\_all\_models }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(horizon) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{mean\_fe =} \FunctionTok{mean}\NormalTok{(forecast\_error, }\AttributeTok{na.rm=}\NormalTok{T),}
    \AttributeTok{var\_fe =} \FunctionTok{sd}\NormalTok{(forecast\_error, }\AttributeTok{na.rm=}\NormalTok{T)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{, }\AttributeTok{n =} \FunctionTok{n}\NormalTok{() )}

\NormalTok{fe\_var\_plot }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(var\_by\_horizon, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ horizon, }\AttributeTok{y =}\NormalTok{ var\_fe)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{color =} \StringTok{"\#2c3e50"}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{color =} \StringTok{"\#e74c3c"}\NormalTok{, }\AttributeTok{size =} \DecValTok{3}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.8}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{14}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{labels =}\NormalTok{ scales}\SpecialCharTok{::}\NormalTok{comma) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Variance of FE by Horizon"}\NormalTok{,}
    \AttributeTok{subtitle =} \FunctionTok{paste}\NormalTok{(}\StringTok{"For model based on:"}\NormalTok{, model\_name),}
    \AttributeTok{x =} \StringTok{"Forecast Horizon"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Variance of FE"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{5}\NormalTok{)),}
        \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey30"}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{10}\NormalTok{)),}
        \AttributeTok{axis.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
        \AttributeTok{axis.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{),}
        \AttributeTok{panel.grid.minor.x =} \FunctionTok{element\_blank}\NormalTok{() )}
\NormalTok{fe\_var\_plot}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{ECB-Project_files/figure-latex/Variance of Forecast Errors-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
  \FunctionTok{ggsave}\NormalTok{(}\AttributeTok{filename =} \StringTok{"FE\_var\_plot.png"}\NormalTok{, }\AttributeTok{path =} \StringTok{"figures/"}\NormalTok{, }\AttributeTok{plot=}\NormalTok{fe\_var\_plot)\}}
\end{Highlighting}
\end{Shaded}

\subsubsection{Horizon 1 Autocorrelation of
FE}\label{horizon-1-autocorrelation-of-fe}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Durbin Watson tests for first autocorrelation at h=1}

\CommentTok{\# Select Forecast Columns}
\NormalTok{formula\_cols }\OtherTok{\textless{}{-}} \FunctionTok{grep}\NormalTok{(}\StringTok{"\^{}F\_TR\_FORMULA\_"}\NormalTok{, }\FunctionTok{names}\NormalTok{(eval\_all\_models), }\AttributeTok{value =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# automatically set max horizon for loop}
\NormalTok{max\_h }\OtherTok{\textless{}{-}} \FunctionTok{max}\NormalTok{(eval\_all\_models}\SpecialCharTok{$}\NormalTok{horizon)}

\CommentTok{\# Loop for each model}
\ControlFlowTok{for}\NormalTok{ (model\_name }\ControlFlowTok{in}\NormalTok{ formula\_cols) \{}

  \CommentTok{\# Extract and regress errors}
\NormalTok{  all\_forecast\_errors }\OtherTok{\textless{}{-}}\NormalTok{ eval\_all\_models[[}\StringTok{"actuals"}\NormalTok{]] }\SpecialCharTok{{-}}\NormalTok{ eval\_all\_models[[model\_name]]}
\NormalTok{  h1\_errors\_vector }\OtherTok{\textless{}{-}}\NormalTok{ all\_forecast\_errors[eval\_all\_models}\SpecialCharTok{$}\NormalTok{horizon }\SpecialCharTok{==} \DecValTok{1}\NormalTok{]}
\NormalTok{  temp\_model }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(h1\_errors\_vector }\SpecialCharTok{\textasciitilde{}} \DecValTok{1}\NormalTok{)}

  \CommentTok{\#Durbin{-}Watson Test}
\NormalTok{  dw\_test\_result }\OtherTok{\textless{}{-}} \FunctionTok{durbinWatsonTest}\NormalTok{(temp\_model)}

  \CommentTok{\# Print output}
  \FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{{-}{-}{-} Durbin{-}Watson Test for Model: \%s (h=1) {-}{-}{-}}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, model\_name))}
  \FunctionTok{print}\NormalTok{(dw\_test\_result)}
  \FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"DW Statistic: \%.4f}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, dw\_test\_result}\SpecialCharTok{$}\NormalTok{statistic))\}}
\end{Highlighting}
\end{Shaded}

--- Durbin-Watson Test for Model: F\_TR\_FORMULA\_1 (h=1) --- lag
Autocorrelation D-W Statistic p-value 1 0.9171088 0.1465333 0
Alternative hypothesis: rho != 0

--- Durbin-Watson Test for Model: F\_TR\_FORMULA\_2 (h=1) --- lag
Autocorrelation D-W Statistic p-value 1 0.8963123 0.1833005 0
Alternative hypothesis: rho != 0

--- Durbin-Watson Test for Model: F\_TR\_FORMULA\_3 (h=1) --- lag
Autocorrelation D-W Statistic p-value 1 0.4862885 0.9168399 0.01
Alternative hypothesis: rho != 0

--- Durbin-Watson Test for Model: F\_TR\_FORMULA\_4 (h=1) --- lag
Autocorrelation D-W Statistic p-value 1 -0.03375527 2.012658 0.964
Alternative hypothesis: rho != 0

\subsubsection{Overall Autocorrelation of
FE}\label{overall-autocorrelation-of-fe}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Ljung Box Test, with Columns \& max lags set in Durbin Watson code chunk}

\CommentTok{\# loop through each TR}
\ControlFlowTok{for}\NormalTok{ (model\_name }\ControlFlowTok{in}\NormalTok{ formula\_cols) \{}
    
    \FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"{-}{-}{-} Checking Errors for Model: \%s {-}{-}{-}}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, model\_name))}
    
    \CommentTok{\# Calculate the errors of the model}
\NormalTok{    all\_errors }\OtherTok{\textless{}{-}}\NormalTok{ eval\_all\_models[[}\StringTok{"actuals"}\NormalTok{]] }\SpecialCharTok{{-}}\NormalTok{ eval\_all\_models[[model\_name]]}
    
    \CommentTok{\# Loop over all forecast horizons to test for autocorrelation}
    \ControlFlowTok{for}\NormalTok{ (h }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{max\_h)\{}
        
        \CommentTok{\# select errors for each horizon}
\NormalTok{        h\_errors }\OtherTok{\textless{}{-}}\NormalTok{ all\_errors[eval\_all\_models}\SpecialCharTok{$}\NormalTok{horizon }\SpecialCharTok{==}\NormalTok{ h]}
            
        \CommentTok{\# max lag according to slides around sqrt T}
\NormalTok{        T\_errors }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(h\_errors)}
\NormalTok{        max\_lag }\OtherTok{\textless{}{-}} \DecValTok{4} \CommentTok{\#round(sqrt(T\_errors)) \# use 4 or 5 chose 4 because 1 year has 4 quarters}
        
        \CommentTok{\# Ljung{-}Box Test}
\NormalTok{        lb\_test\_result }\OtherTok{\textless{}{-}} \FunctionTok{Box.test}\NormalTok{(h\_errors, }
                                   \AttributeTok{lag =}\NormalTok{ max\_lag, }
                                   \AttributeTok{type =} \StringTok{"Ljung{-}Box"}\NormalTok{)}
        
        \CommentTok{\#Print Results}
        \FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"Horizon h=\%d (N=\%d, Lags=\%d): Q=\%.2f, p{-}value=\%.3f}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }
\NormalTok{                    h, T\_errors, max\_lag, lb\_test\_result}\SpecialCharTok{$}\NormalTok{statistic, lb\_test\_result}\SpecialCharTok{$}\NormalTok{p.value))\}}
        \FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)\}}
\end{Highlighting}
\end{Shaded}

--- Checking Errors for Model: F\_TR\_FORMULA\_1 --- Horizon h=1 (N=21,
Lags=4): Q=45.00, p-value=0.000 Horizon h=2 (N=21, Lags=4): Q=42.92,
p-value=0.000 Horizon h=3 (N=21, Lags=4): Q=42.05, p-value=0.000 Horizon
h=4 (N=21, Lags=4): Q=38.36, p-value=0.000 Horizon h=5 (N=21, Lags=4):
Q=25.89, p-value=0.000 Horizon h=6 (N=21, Lags=4): Q=15.52,
p-value=0.004 Horizon h=7 (N=21, Lags=4): Q=9.76, p-value=0.045 Horizon
h=8 (N=21, Lags=4): Q=9.16, p-value=0.057 Horizon h=9 (N=21, Lags=4):
Q=6.65, p-value=0.156 Horizon h=10 (N=21, Lags=4): Q=7.86, p-value=0.097

--- Checking Errors for Model: F\_TR\_FORMULA\_2 --- Horizon h=1 (N=21,
Lags=4): Q=40.42, p-value=0.000 Horizon h=2 (N=21, Lags=4): Q=28.79,
p-value=0.000 Horizon h=3 (N=21, Lags=4): Q=16.25, p-value=0.003 Horizon
h=4 (N=21, Lags=4): Q=4.99, p-value=0.288 Horizon h=5 (N=21, Lags=4):
Q=1.96, p-value=0.743 Horizon h=6 (N=21, Lags=4): Q=1.50, p-value=0.826
Horizon h=7 (N=21, Lags=4): Q=1.46, p-value=0.834 Horizon h=8 (N=21,
Lags=4): Q=0.97, p-value=0.914 Horizon h=9 (N=21, Lags=4): Q=0.79,
p-value=0.940 Horizon h=10 (N=21, Lags=4): Q=0.58, p-value=0.965

--- Checking Errors for Model: F\_TR\_FORMULA\_3 --- Horizon h=1 (N=21,
Lags=4): Q=7.84, p-value=0.098 Horizon h=2 (N=21, Lags=4): Q=13.20,
p-value=0.010 Horizon h=3 (N=21, Lags=4): Q=13.20, p-value=0.010 Horizon
h=4 (N=21, Lags=4): Q=15.47, p-value=0.004 Horizon h=5 (N=21, Lags=4):
Q=14.68, p-value=0.005 Horizon h=6 (N=21, Lags=4): Q=14.65,
p-value=0.005 Horizon h=7 (N=21, Lags=4): Q=14.39, p-value=0.006 Horizon
h=8 (N=21, Lags=4): Q=13.23, p-value=0.010 Horizon h=9 (N=21, Lags=4):
Q=9.01, p-value=0.061 Horizon h=10 (N=21, Lags=4): Q=4.29, p-value=0.369

--- Checking Errors for Model: F\_TR\_FORMULA\_4 --- Horizon h=1 (N=21,
Lags=4): Q=1.22, p-value=0.876 Horizon h=2 (N=21, Lags=4): Q=8.79,
p-value=0.067 Horizon h=3 (N=21, Lags=4): Q=11.42, p-value=0.022 Horizon
h=4 (N=21, Lags=4): Q=12.22, p-value=0.016 Horizon h=5 (N=21, Lags=4):
Q=11.46, p-value=0.022 Horizon h=6 (N=21, Lags=4): Q=10.84,
p-value=0.028 Horizon h=7 (N=21, Lags=4): Q=11.37, p-value=0.023 Horizon
h=8 (N=21, Lags=4): Q=12.17, p-value=0.016 Horizon h=9 (N=21, Lags=4):
Q=11.72, p-value=0.020 Horizon h=10 (N=21, Lags=4): Q=10.38,
p-value=0.034

\subsection{Absolute Performance: Efficiency \&
Bias}\label{absolute-performance-efficiency-bias}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Call MZ{-}test helper function 4 times.}
\CommentTok{\#  Note: These reports is wrapped in trycatch as it sometimes fails}
\CommentTok{\#         If it does fail, simply decrease R in order to have more }
\CommentTok{\#          observations, removing potential multicolinearity.}

\CommentTok{\# MZ Report 1: Actual Rate, No Lag}
\NormalTok{mz\_report\_1 }\OtherTok{\textless{}{-}} \FunctionTok{tryCatch}\NormalTok{(\{}
  \FunctionTok{generate\_mincer\_zarnowitz\_report}\NormalTok{(}
    \AttributeTok{F\_model =}\NormalTok{ F\_TR\_1,}
    \AttributeTok{Actual\_values =}\NormalTok{ Actuals,}
    \AttributeTok{H =}\NormalTok{ H,}
    \AttributeTok{model\_caption =} \StringTok{"Mincer{-}Zarnowitz Test: Actual Rate, No Lag"}\NormalTok{,}
    \AttributeTok{format =}\NormalTok{ format)\}, }\AttributeTok{error =} \ControlFlowTok{function}\NormalTok{(e) \{}
  \FunctionTok{message}\NormalTok{(}\StringTok{"Error generating MZ Report (Actual Rate, No Lag): "}\NormalTok{, e}\SpecialCharTok{$}\NormalTok{message)}
  \FunctionTok{message}\NormalTok{(}\StringTok{"Skipping this report and continuing..."}\NormalTok{)}
  \FunctionTok{return}\NormalTok{(}\ConstantTok{NULL}\NormalTok{)\})}

\CommentTok{\# MZ Report 2: Shadow Rate, No Lag (}
\NormalTok{mz\_report\_2 }\OtherTok{\textless{}{-}} \FunctionTok{tryCatch}\NormalTok{(\{}
  \FunctionTok{generate\_mincer\_zarnowitz\_report}\NormalTok{(}
    \AttributeTok{F\_model =}\NormalTok{ F\_TR\_2,}
    \AttributeTok{Actual\_values =}\NormalTok{ Actuals,}
    \AttributeTok{H =}\NormalTok{ H,}
    \AttributeTok{model\_caption =} \StringTok{"Mincer{-}Zarnowitz Test: Shadow Rate, No Lag"}\NormalTok{,}
    \AttributeTok{format =}\NormalTok{ format)\}, }\AttributeTok{error =} \ControlFlowTok{function}\NormalTok{(e) \{}
  \FunctionTok{message}\NormalTok{(}\StringTok{"Error generating MZ Report (Shadow Rate, No Lag): "}\NormalTok{, e}\SpecialCharTok{$}\NormalTok{message)}
  \FunctionTok{message}\NormalTok{(}\StringTok{"Skipping this report and continuing..."}\NormalTok{)}
  \FunctionTok{return}\NormalTok{(}\ConstantTok{NULL}\NormalTok{)\})}

\CommentTok{\# MZ Report 3: Actual Rate, with Lag}
\NormalTok{mz\_report\_3 }\OtherTok{\textless{}{-}} \FunctionTok{tryCatch}\NormalTok{(\{}
  \FunctionTok{generate\_mincer\_zarnowitz\_report}\NormalTok{(}
    \AttributeTok{F\_model =}\NormalTok{ F\_TR\_3,}
    \AttributeTok{Actual\_values =}\NormalTok{ Actuals,}
    \AttributeTok{H =}\NormalTok{ H,}
    \AttributeTok{model\_caption =} \StringTok{"Mincer{-}Zarnowitz Test: Actual Rate, with Lag"}\NormalTok{,}
    \AttributeTok{format =}\NormalTok{ format)\}, }\AttributeTok{error =} \ControlFlowTok{function}\NormalTok{(e) \{}
  \FunctionTok{message}\NormalTok{(}\StringTok{"Error generating MZ Report (Actual Rate, with Lag): "}\NormalTok{, e}\SpecialCharTok{$}\NormalTok{message)}
  \FunctionTok{message}\NormalTok{(}\StringTok{"Skipping this report and continuing..."}\NormalTok{)}
  \FunctionTok{return}\NormalTok{(}\ConstantTok{NULL}\NormalTok{)\})}

\CommentTok{\# MZ Report 4: Shadow Rate, with Lag}
\NormalTok{mz\_report\_4 }\OtherTok{\textless{}{-}} \FunctionTok{tryCatch}\NormalTok{(\{}
  \FunctionTok{generate\_mincer\_zarnowitz\_report}\NormalTok{(}
    \AttributeTok{F\_model =}\NormalTok{ F\_TR\_4,}
    \AttributeTok{Actual\_values =}\NormalTok{ Actuals,}
    \AttributeTok{H =}\NormalTok{ H,}
    \AttributeTok{model\_caption =} \StringTok{"Mincer{-}Zarnowitz Test: Shadow Rate, with Lag"}\NormalTok{,}
    \AttributeTok{format =}\NormalTok{ format)\}, }\AttributeTok{error =} \ControlFlowTok{function}\NormalTok{(e) \{}
  \FunctionTok{message}\NormalTok{(}\StringTok{"Error generating MZ Report (Shadow Rate, with Lag): "}\NormalTok{, e}\SpecialCharTok{$}\NormalTok{message)}
  \FunctionTok{message}\NormalTok{(}\StringTok{"Skipping this report and continuing..."}\NormalTok{)}
  \FunctionTok{return}\NormalTok{(}\ConstantTok{NULL}\NormalTok{)\})}

\CommentTok{\# MZ Report 5: Benchmark}
\NormalTok{mz\_report\_BM }\OtherTok{\textless{}{-}} \FunctionTok{tryCatch}\NormalTok{(\{}
  \FunctionTok{generate\_mincer\_zarnowitz\_report}\NormalTok{(}
    \AttributeTok{F\_model =}\NormalTok{ F\_BM,}
    \AttributeTok{Actual\_values =}\NormalTok{ Actuals,}
    \AttributeTok{H =}\NormalTok{ H,}
    \AttributeTok{model\_caption =} \StringTok{"Mincer{-}Zarnowitz Test: Benchmark ARIMA"}\NormalTok{,}
    \AttributeTok{format =}\NormalTok{ format)\}, }\AttributeTok{error =} \ControlFlowTok{function}\NormalTok{(e) \{}
  \FunctionTok{message}\NormalTok{(}\StringTok{"Error generating MZ Report (Benchmark ARIMA): "}\NormalTok{, e}\SpecialCharTok{$}\NormalTok{message)}
  \FunctionTok{message}\NormalTok{(}\StringTok{"Skipping this report and continuing..."}\NormalTok{)}
  \FunctionTok{return}\NormalTok{(}\ConstantTok{NULL}\NormalTok{)\})}

\FunctionTok{list}\NormalTok{(mz\_report\_1, mz\_report\_2, mz\_report\_3, mz\_report\_4, mz\_report\_BM)}
\end{Highlighting}
\end{Shaded}

{[}{[}1{]}{]}

\begin{table}
\centering
\caption{\label{tab:forecast-model-efficiency}Mincer-Zarnowitz Test: Actual Rate, No Lag}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{threeparttable}
\begin{tabular}[t]{>{}r|rr>{}l}
\toprule
h & Alpha & Beta & pv(Joint)\\
\midrule
\textbf{\cellcolor{gray!10}{1}} & \cellcolor{gray!10}{1.1720} & \cellcolor{gray!10}{0.3204} & \ttfamily{\cellcolor{gray!10}{0.2184}}\\
\textbf{2} & 1.2241 & 0.3856 & \ttfamily{0.7727}\\
\textbf{\cellcolor{gray!10}{3}} & \cellcolor{gray!10}{0.9667} & \cellcolor{gray!10}{0.8076} & \ttfamily{\cellcolor{gray!10}{0.8783}}\\
\textbf{4} & 0.7954 & 1.2455 & \ttfamily{0.2386}\\
\textbf{\cellcolor{gray!10}{5}} & \cellcolor{gray!10}{0.8566} & \cellcolor{gray!10}{1.4292} & \ttfamily{\cellcolor{gray!10}{0.0103 **}}\\
\addlinespace
\textbf{6} & 1.0184 & 1.4755 & \ttfamily{0.0000 ***}\\
\textbf{\cellcolor{gray!10}{7}} & \cellcolor{gray!10}{1.2284} & \cellcolor{gray!10}{1.3395} & \ttfamily{\cellcolor{gray!10}{0.0000 ***}}\\
\textbf{8} & 1.6036 & 1.0913 & \ttfamily{0.0000 ***}\\
\textbf{\cellcolor{gray!10}{9}} & \cellcolor{gray!10}{2.2021} & \cellcolor{gray!10}{0.6248} & \ttfamily{\cellcolor{gray!10}{0.0001 ***}}\\
\textbf{10} & 2.9629 & 0.0414 & \ttfamily{0.0030 ***}\\
\bottomrule
\end{tabular}
\begin{tablenotes}[para]
\item \textit{Note:} 
\item pv(Joint) is the p-value for the joint hypothesis H\_0: (Alpha, Beta) = (0, 1). A high p-value means we fail to reject the null hypothesis of an unbiased, efficient forecast.
\item[*] Signif. codes:  '***' 0.01,  '**' 0.05,  '*' 0.1
\end{tablenotes}
\end{threeparttable}}
\end{table}

{[}{[}2{]}{]}

\begin{table}
\centering
\caption{\label{tab:forecast-model-efficiency}Mincer-Zarnowitz Test: Shadow Rate, No Lag}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{threeparttable}
\begin{tabular}[t]{>{}r|rr>{}l}
\toprule
h & Alpha & Beta & pv(Joint)\\
\midrule
\textbf{\cellcolor{gray!10}{1}} & \cellcolor{gray!10}{1.8201} & \cellcolor{gray!10}{-0.3634} & \ttfamily{\cellcolor{gray!10}{0.000 ***}}\\
\textbf{2} & 1.8580 & -0.2293 & \ttfamily{0.000 ***}\\
\textbf{\cellcolor{gray!10}{3}} & \cellcolor{gray!10}{1.7647} & \cellcolor{gray!10}{-0.0424} & \ttfamily{\cellcolor{gray!10}{0.000 ***}}\\
\textbf{4} & 1.8174 & 0.0116 & \ttfamily{0.000 ***}\\
\textbf{\cellcolor{gray!10}{5}} & \cellcolor{gray!10}{1.9914} & \cellcolor{gray!10}{-0.0130} & \ttfamily{\cellcolor{gray!10}{0.000 ***}}\\
\addlinespace
\textbf{6} & 2.2061 & -0.0425 & \ttfamily{0.000 ***}\\
\textbf{\cellcolor{gray!10}{7}} & \cellcolor{gray!10}{2.4557} & \cellcolor{gray!10}{-0.0697} & \ttfamily{\cellcolor{gray!10}{0.000 ***}}\\
\textbf{8} & 2.7436 & -0.0941 & \ttfamily{0.000 ***}\\
\textbf{\cellcolor{gray!10}{9}} & \cellcolor{gray!10}{2.9320} & \cellcolor{gray!10}{-0.0671} & \ttfamily{\cellcolor{gray!10}{0.000 ***}}\\
\textbf{10} & 3.1602 & -0.0452 & \ttfamily{0.000 ***}\\
\bottomrule
\end{tabular}
\begin{tablenotes}[para]
\item \textit{Note:} 
\item pv(Joint) is the p-value for the joint hypothesis H\_0: (Alpha, Beta) = (0, 1). A high p-value means we fail to reject the null hypothesis of an unbiased, efficient forecast.
\item[*] Signif. codes:  '***' 0.01,  '**' 0.05,  '*' 0.1
\end{tablenotes}
\end{threeparttable}}
\end{table}

{[}{[}3{]}{]}

\begin{table}
\centering
\caption{\label{tab:forecast-model-efficiency}Mincer-Zarnowitz Test: Actual Rate, with Lag}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{threeparttable}
\begin{tabular}[t]{>{}r|rr>{}l}
\toprule
h & Alpha & Beta & pv(Joint)\\
\midrule
\textbf{\cellcolor{gray!10}{1}} & \cellcolor{gray!10}{0.0568} & \cellcolor{gray!10}{1.0019} & \ttfamily{\cellcolor{gray!10}{0.7940}}\\
\textbf{2} & 0.2189 & 0.9525 & \ttfamily{0.7692}\\
\textbf{\cellcolor{gray!10}{3}} & \cellcolor{gray!10}{0.4630} & \cellcolor{gray!10}{0.8861} & \ttfamily{\cellcolor{gray!10}{0.7036}}\\
\textbf{4} & 0.7537 & 0.8270 & \ttfamily{0.6691}\\
\textbf{\cellcolor{gray!10}{5}} & \cellcolor{gray!10}{1.1378} & \cellcolor{gray!10}{0.6906} & \ttfamily{\cellcolor{gray!10}{0.5505}}\\
\addlinespace
\textbf{6} & 1.4947 & 0.5933 & \ttfamily{0.4541}\\
\textbf{\cellcolor{gray!10}{7}} & \cellcolor{gray!10}{1.9075} & \cellcolor{gray!10}{0.4131} & \ttfamily{\cellcolor{gray!10}{0.1574}}\\
\textbf{8} & 2.3049 & 0.2375 & \ttfamily{0.0148 **}\\
\textbf{\cellcolor{gray!10}{9}} & \cellcolor{gray!10}{2.7110} & \cellcolor{gray!10}{0.0277} & \ttfamily{\cellcolor{gray!10}{0.0010 ***}}\\
\textbf{10} & 3.0873 & -0.1496 & \ttfamily{0.0003 ***}\\
\bottomrule
\end{tabular}
\begin{tablenotes}[para]
\item \textit{Note:} 
\item pv(Joint) is the p-value for the joint hypothesis H\_0: (Alpha, Beta) = (0, 1). A high p-value means we fail to reject the null hypothesis of an unbiased, efficient forecast.
\item[*] Signif. codes:  '***' 0.01,  '**' 0.05,  '*' 0.1
\end{tablenotes}
\end{threeparttable}}
\end{table}

{[}{[}4{]}{]}

\begin{table}
\centering
\caption{\label{tab:forecast-model-efficiency}Mincer-Zarnowitz Test: Shadow Rate, with Lag}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{threeparttable}
\begin{tabular}[t]{>{}r|rr>{}l}
\toprule
h & Alpha & Beta & pv(Joint)\\
\midrule
\textbf{\cellcolor{gray!10}{1}} & \cellcolor{gray!10}{0.0533} & \cellcolor{gray!10}{0.9137} & \ttfamily{\cellcolor{gray!10}{0.0771 *}}\\
\textbf{2} & 0.1926 & 0.7985 & \ttfamily{0.1967}\\
\textbf{\cellcolor{gray!10}{3}} & \cellcolor{gray!10}{0.4409} & \cellcolor{gray!10}{0.6390} & \ttfamily{\cellcolor{gray!10}{0.0084 ***}}\\
\textbf{4} & 0.7725 & 0.4865 & \ttfamily{0.0000 ***}\\
\textbf{\cellcolor{gray!10}{5}} & \cellcolor{gray!10}{1.1435} & \cellcolor{gray!10}{0.3537} & \ttfamily{\cellcolor{gray!10}{0.0000 ***}}\\
\addlinespace
\textbf{6} & 1.4715 & 0.2535 & \ttfamily{0.0000 ***}\\
\textbf{\cellcolor{gray!10}{7}} & \cellcolor{gray!10}{1.8170} & \cellcolor{gray!10}{0.1656} & \ttfamily{\cellcolor{gray!10}{0.0000 ***}}\\
\textbf{8} & 2.2158 & 0.0884 & \ttfamily{0.0000 ***}\\
\textbf{\cellcolor{gray!10}{9}} & \cellcolor{gray!10}{2.6636} & \cellcolor{gray!10}{0.0189} & \ttfamily{\cellcolor{gray!10}{0.0000 ***}}\\
\textbf{10} & 3.1629 & -0.0418 & \ttfamily{0.0000 ***}\\
\bottomrule
\end{tabular}
\begin{tablenotes}[para]
\item \textit{Note:} 
\item pv(Joint) is the p-value for the joint hypothesis H\_0: (Alpha, Beta) = (0, 1). A high p-value means we fail to reject the null hypothesis of an unbiased, efficient forecast.
\item[*] Signif. codes:  '***' 0.01,  '**' 0.05,  '*' 0.1
\end{tablenotes}
\end{threeparttable}}
\end{table}

{[}{[}5{]}{]}

\begin{table}
\centering
\caption{\label{tab:forecast-model-efficiency}Mincer-Zarnowitz Test: Benchmark ARIMA}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{threeparttable}
\begin{tabular}[t]{>{}r|rr>{}l}
\toprule
h & Alpha & Beta & pv(Joint)\\
\midrule
\textbf{\cellcolor{gray!10}{1}} & \cellcolor{gray!10}{0.1403} & \cellcolor{gray!10}{0.9439} & \ttfamily{\cellcolor{gray!10}{0.4025}}\\
\textbf{2} & 0.3980 & 0.8509 & \ttfamily{0.1991}\\
\textbf{\cellcolor{gray!10}{3}} & \cellcolor{gray!10}{0.7262} & \cellcolor{gray!10}{0.7193} & \ttfamily{\cellcolor{gray!10}{0.2696}}\\
\textbf{4} & 1.0868 & 0.5906 & \ttfamily{0.3892}\\
\textbf{\cellcolor{gray!10}{5}} & \cellcolor{gray!10}{1.4665} & \cellcolor{gray!10}{0.4339} & \ttfamily{\cellcolor{gray!10}{0.2697}}\\
\addlinespace
\textbf{6} & 1.8291 & 0.3006 & \ttfamily{0.1350}\\
\textbf{\cellcolor{gray!10}{7}} & \cellcolor{gray!10}{2.1804} & \cellcolor{gray!10}{0.1495} & \ttfamily{\cellcolor{gray!10}{0.3461}}\\
\textbf{8} & 2.4846 & 0.0308 & \ttfamily{0.0078 ***}\\
\textbf{\cellcolor{gray!10}{9}} & \cellcolor{gray!10}{2.7628} & \cellcolor{gray!10}{-0.1282} & \ttfamily{\cellcolor{gray!10}{0.0000 ***}}\\
\textbf{10} & 2.9597 & -0.3873 & \ttfamily{0.0000 ***}\\
\bottomrule
\end{tabular}
\begin{tablenotes}[para]
\item \textit{Note:} 
\item pv(Joint) is the p-value for the joint hypothesis H\_0: (Alpha, Beta) = (0, 1). A high p-value means we fail to reject the null hypothesis of an unbiased, efficient forecast.
\item[*] Signif. codes:  '***' 0.01,  '**' 0.05,  '*' 0.1
\end{tablenotes}
\end{threeparttable}}
\end{table}

\subsection{Relative Performance (against
benchmark)}\label{relative-performance-against-benchmark}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Call DM{-}test helper function 4 times.}

\CommentTok{\# Report 1: Actual Rate, No Lag}
\NormalTok{report\_1 }\OtherTok{\textless{}{-}} \FunctionTok{generate\_report\_table}\NormalTok{(}
  \AttributeTok{FE\_TR\_model =}\NormalTok{ FE\_TR\_1,}
  \AttributeTok{FE\_BM\_model =}\NormalTok{ FE\_BM,}
  \AttributeTok{H =}\NormalTok{ H,}
  \AttributeTok{model\_caption =} \StringTok{"MSFE Comparison, Trained on Actual Rate, No Lag"}\NormalTok{,}
  \AttributeTok{format =}\NormalTok{ format)}

\CommentTok{\# Report 2: Shadow Rate, No Lag}
\NormalTok{report\_2 }\OtherTok{\textless{}{-}} \FunctionTok{generate\_report\_table}\NormalTok{(}
  \AttributeTok{FE\_TR\_model =}\NormalTok{ FE\_TR\_2,}
  \AttributeTok{FE\_BM\_model =}\NormalTok{ FE\_BM,}
  \AttributeTok{H =}\NormalTok{ H,}
  \AttributeTok{model\_caption =} \StringTok{"MSFE Comparison, Trained on Shadow Rate, No Lag"}\NormalTok{,}
  \AttributeTok{format =}\NormalTok{ format)}

\CommentTok{\# Report 3: Actual Rate, with Lag}
\NormalTok{report\_3 }\OtherTok{\textless{}{-}} \FunctionTok{generate\_report\_table}\NormalTok{(}
  \AttributeTok{FE\_TR\_model =}\NormalTok{ FE\_TR\_3,}
  \AttributeTok{FE\_BM\_model =}\NormalTok{ FE\_BM,}
  \AttributeTok{H =}\NormalTok{ H,}
  \AttributeTok{model\_caption =} \StringTok{"MSFE Comparison, Trained on Actual Rate, with Lag"}\NormalTok{,}
  \AttributeTok{format =}\NormalTok{ format)}

\CommentTok{\# Report 4: Shadow Rate, with Lag}
\NormalTok{report\_4 }\OtherTok{\textless{}{-}} \FunctionTok{generate\_report\_table}\NormalTok{(}
  \AttributeTok{FE\_TR\_model =}\NormalTok{ FE\_TR\_4,}
  \AttributeTok{FE\_BM\_model =}\NormalTok{ FE\_BM,}
  \AttributeTok{H =}\NormalTok{ H,}
  \AttributeTok{model\_caption =} \StringTok{"MSFE Comparison, Trained on Shadow Rate, with Lag"}\NormalTok{,}
  \AttributeTok{format =}\NormalTok{ format)}

\FunctionTok{list}\NormalTok{(report\_1, report\_2, report\_3, report\_4)}
\end{Highlighting}
\end{Shaded}

{[}{[}1{]}{]}

\begin{table}
\centering
\caption{\label{tab:forecast-model-perf}MSFE Comparison, Trained on Actual Rate, No Lag}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{threeparttable}
\begin{tabular}[t]{>{}r|rrr>{}l>{}l>{}l}
\toprule
h & MSFE TR & MSFE BM & Ratio & DM Two-Sided & DM Greater & DM Lesser\\
\midrule
\textbf{\cellcolor{gray!10}{1}} & \cellcolor{gray!10}{4.0655} & \cellcolor{gray!10}{0.1637} & \cellcolor{gray!10}{24.8364} & \ttfamily{\cellcolor{gray!10}{0.0001 ***}} & \ttfamily{\cellcolor{gray!10}{0.9999}} & \ttfamily{\cellcolor{gray!10}{0.0001 ***}}\\
\textbf{2} & 4.0938 & 0.6781 & 6.0369 & \ttfamily{0.0355 **} & \ttfamily{0.9823} & \ttfamily{0.0177 **}\\
\textbf{\cellcolor{gray!10}{3}} & \cellcolor{gray!10}{3.5461} & \cellcolor{gray!10}{1.6776} & \cellcolor{gray!10}{2.1137} & \ttfamily{\cellcolor{gray!10}{0.4047}} & \ttfamily{\cellcolor{gray!10}{0.7977}} & \ttfamily{\cellcolor{gray!10}{0.2023}}\\
\textbf{4} & 3.1944 & 2.8924 & 1.1044 & \ttfamily{0.9159} & \ttfamily{0.5421} & \ttfamily{0.4579}\\
\textbf{\cellcolor{gray!10}{5}} & \cellcolor{gray!10}{3.1434} & \cellcolor{gray!10}{4.4596} & \cellcolor{gray!10}{0.7049} & \ttfamily{\cellcolor{gray!10}{0.5990}} & \ttfamily{\cellcolor{gray!10}{0.2995}} & \ttfamily{\cellcolor{gray!10}{0.7005}}\\
\addlinespace
\textbf{6} & 3.3438 & 5.9961 & 0.5577 & \ttfamily{0.1229} & \ttfamily{0.0614 *} & \ttfamily{0.9386}\\
\textbf{\cellcolor{gray!10}{7}} & \cellcolor{gray!10}{3.6083} & \cellcolor{gray!10}{7.7500} & \cellcolor{gray!10}{0.4656} & \ttfamily{\cellcolor{gray!10}{0.0120 **}} & \ttfamily{\cellcolor{gray!10}{0.0060 ***}} & \ttfamily{\cellcolor{gray!10}{0.9940}}\\
\textbf{8} & 4.1964 & 9.0357 & 0.4644 & \ttfamily{0.0020 ***} & \ttfamily{0.0010 ***} & \ttfamily{0.9990}\\
\textbf{\cellcolor{gray!10}{9}} & \cellcolor{gray!10}{5.0865} & \cellcolor{gray!10}{10.7260} & \cellcolor{gray!10}{0.4742} & \ttfamily{\cellcolor{gray!10}{0.0002 ***}} & \ttfamily{\cellcolor{gray!10}{0.0001 ***}} & \ttfamily{\cellcolor{gray!10}{0.9999}}\\
\textbf{10} & 6.1823 & 12.0156 & 0.5145 & \ttfamily{0.0000 ***} & \ttfamily{0.0000 ***} & \ttfamily{1.0000}\\
\bottomrule
\end{tabular}
\begin{tablenotes}[para]
\item \textit{Note:} 
\item TR refers to the forecast made with an estimated Taylor Rule. BM refers to a benchmark of the interest rate using an ARIMA model. Ratio < 1 indicates that the TR model has lower MSFE.
\item \textit{DM Test Alternative Hypotheses (H\_A):} 
\item[*] 'DM Greater' tests if the TR model is significantly more accurate than the BM model.
\item[\dag] 'DM Lesser' tests if the TR model is significantly less accurate than the BM model.
\end{tablenotes}
\end{threeparttable}}
\end{table}

{[}{[}2{]}{]}

\begin{table}
\centering
\caption{\label{tab:forecast-model-perf}MSFE Comparison, Trained on Shadow Rate, No Lag}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{threeparttable}
\begin{tabular}[t]{>{}r|rrr>{}l>{}l>{}l}
\toprule
h & MSFE TR & MSFE BM & Ratio & DM Two-Sided & DM Greater & DM Lesser\\
\midrule
\textbf{\cellcolor{gray!10}{1}} & \cellcolor{gray!10}{8.8750} & \cellcolor{gray!10}{0.1637} & \cellcolor{gray!10}{54.2182} & \ttfamily{\cellcolor{gray!10}{0.0001 ***}} & \ttfamily{\cellcolor{gray!10}{1.0000}} & \ttfamily{\cellcolor{gray!10}{0.0000 ***}}\\
\textbf{2} & 9.6375 & 0.6781 & 14.2120 & \ttfamily{0.0024 ***} & \ttfamily{0.9988} & \ttfamily{0.0012 ***}\\
\textbf{\cellcolor{gray!10}{3}} & \cellcolor{gray!10}{9.6678} & \cellcolor{gray!10}{1.6776} & \cellcolor{gray!10}{5.7627} & \ttfamily{\cellcolor{gray!10}{0.0371 **}} & \ttfamily{\cellcolor{gray!10}{0.9815}} & \ttfamily{\cellcolor{gray!10}{0.0185 **}}\\
\textbf{4} & 12.3715 & 2.8924 & 4.2773 & \ttfamily{0.2245} & \ttfamily{0.8878} & \ttfamily{0.1122}\\
\textbf{\cellcolor{gray!10}{5}} & \cellcolor{gray!10}{17.0404} & \cellcolor{gray!10}{4.4596} & \cellcolor{gray!10}{3.8211} & \ttfamily{\cellcolor{gray!10}{0.3261}} & \ttfamily{\cellcolor{gray!10}{0.8369}} & \ttfamily{\cellcolor{gray!10}{0.1631}}\\
\addlinespace
\textbf{6} & 23.9844 & 5.9961 & 4.0000 & \ttfamily{0.3694} & \ttfamily{0.8153} & \ttfamily{0.1847}\\
\textbf{\cellcolor{gray!10}{7}} & \cellcolor{gray!10}{31.9167} & \cellcolor{gray!10}{7.7500} & \cellcolor{gray!10}{4.1183} & \ttfamily{\cellcolor{gray!10}{0.3853}} & \ttfamily{\cellcolor{gray!10}{0.8073}} & \ttfamily{\cellcolor{gray!10}{0.1927}}\\
\textbf{8} & 43.1384 & 9.0357 & 4.7742 & \ttfamily{0.3166} & \ttfamily{0.8417} & \ttfamily{0.1583}\\
\textbf{\cellcolor{gray!10}{9}} & \cellcolor{gray!10}{51.8942} & \cellcolor{gray!10}{10.7260} & \cellcolor{gray!10}{4.8382} & \ttfamily{\cellcolor{gray!10}{0.2251}} & \ttfamily{\cellcolor{gray!10}{0.8875}} & \ttfamily{\cellcolor{gray!10}{0.1125}}\\
\textbf{10} & 63.5208 & 12.0156 & 5.2865 & \ttfamily{0.0521 *} & \ttfamily{0.9739} & \ttfamily{0.0261 **}\\
\bottomrule
\end{tabular}
\begin{tablenotes}[para]
\item \textit{Note:} 
\item TR refers to the forecast made with an estimated Taylor Rule. BM refers to a benchmark of the interest rate using an ARIMA model. Ratio < 1 indicates that the TR model has lower MSFE.
\item \textit{DM Test Alternative Hypotheses (H\_A):} 
\item[*] 'DM Greater' tests if the TR model is significantly more accurate than the BM model.
\item[\dag] 'DM Lesser' tests if the TR model is significantly less accurate than the BM model.
\end{tablenotes}
\end{threeparttable}}
\end{table}

{[}{[}3{]}{]}

\begin{table}
\centering
\caption{\label{tab:forecast-model-perf}MSFE Comparison, Trained on Actual Rate, with Lag}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{threeparttable}
\begin{tabular}[t]{>{}r|rrr>{}l>{}l>{}l}
\toprule
h & MSFE TR & MSFE BM & Ratio & DM Two-Sided & DM Greater & DM Lesser\\
\midrule
\textbf{\cellcolor{gray!10}{1}} & \cellcolor{gray!10}{0.1399} & \cellcolor{gray!10}{0.1637} & \cellcolor{gray!10}{0.8545} & \ttfamily{\cellcolor{gray!10}{0.5402}} & \ttfamily{\cellcolor{gray!10}{0.2701}} & \ttfamily{\cellcolor{gray!10}{0.7299}}\\
\textbf{2} & 0.4625 & 0.6781 & 0.6820 & \ttfamily{0.1832} & \ttfamily{0.0916 *} & \ttfamily{0.9084}\\
\textbf{\cellcolor{gray!10}{3}} & \cellcolor{gray!10}{1.0099} & \cellcolor{gray!10}{1.6776} & \cellcolor{gray!10}{0.6020} & \ttfamily{\cellcolor{gray!10}{0.1328}} & \ttfamily{\cellcolor{gray!10}{0.0664 *}} & \ttfamily{\cellcolor{gray!10}{0.9336}}\\
\textbf{4} & 1.6319 & 2.8924 & 0.5642 & \ttfamily{0.1117} & \ttfamily{0.0559 *} & \ttfamily{0.9441}\\
\textbf{\cellcolor{gray!10}{5}} & \cellcolor{gray!10}{2.6250} & \cellcolor{gray!10}{4.4596} & \cellcolor{gray!10}{0.5886} & \ttfamily{\cellcolor{gray!10}{0.0449 **}} & \ttfamily{\cellcolor{gray!10}{0.0224 **}} & \ttfamily{\cellcolor{gray!10}{0.9776}}\\
\addlinespace
\textbf{6} & 3.6172 & 5.9961 & 0.6033 & \ttfamily{0.0143 **} & \ttfamily{0.0072 ***} & \ttfamily{0.9928}\\
\textbf{\cellcolor{gray!10}{7}} & \cellcolor{gray!10}{5.0292} & \cellcolor{gray!10}{7.7500} & \cellcolor{gray!10}{0.6489} & \ttfamily{\cellcolor{gray!10}{0.0143 **}} & \ttfamily{\cellcolor{gray!10}{0.0072 ***}} & \ttfamily{\cellcolor{gray!10}{0.9928}}\\
\textbf{8} & 6.5804 & 9.0357 & 0.7283 & \ttfamily{0.0000 ***} & \ttfamily{0.0000 ***} & \ttfamily{1.0000}\\
\textbf{\cellcolor{gray!10}{9}} & \cellcolor{gray!10}{8.5817} & \cellcolor{gray!10}{10.7260} & \cellcolor{gray!10}{0.8001} & \ttfamily{\cellcolor{gray!10}{0.0220 **}} & \ttfamily{\cellcolor{gray!10}{0.0110 **}} & \ttfamily{\cellcolor{gray!10}{0.9890}}\\
\textbf{10} & 10.5417 & 12.0156 & 0.8773 & \ttfamily{0.1656} & \ttfamily{0.0828 *} & \ttfamily{0.9172}\\
\bottomrule
\end{tabular}
\begin{tablenotes}[para]
\item \textit{Note:} 
\item TR refers to the forecast made with an estimated Taylor Rule. BM refers to a benchmark of the interest rate using an ARIMA model. Ratio < 1 indicates that the TR model has lower MSFE.
\item \textit{DM Test Alternative Hypotheses (H\_A):} 
\item[*] 'DM Greater' tests if the TR model is significantly more accurate than the BM model.
\item[\dag] 'DM Lesser' tests if the TR model is significantly less accurate than the BM model.
\end{tablenotes}
\end{threeparttable}}
\end{table}

{[}{[}4{]}{]}

\begin{table}
\centering
\caption{\label{tab:forecast-model-perf}MSFE Comparison, Trained on Shadow Rate, with Lag}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{threeparttable}
\begin{tabular}[t]{>{}r|rrr>{}l>{}l>{}l}
\toprule
h & MSFE TR & MSFE BM & Ratio & DM Two-Sided & DM Greater & DM Lesser\\
\midrule
\textbf{\cellcolor{gray!10}{1}} & \cellcolor{gray!10}{0.1637} & \cellcolor{gray!10}{0.1637} & \cellcolor{gray!10}{1.0000} & \ttfamily{\cellcolor{gray!10}{1.0000}} & \ttfamily{\cellcolor{gray!10}{0.5000}} & \ttfamily{\cellcolor{gray!10}{0.5000}}\\
\textbf{2} & 0.5781 & 0.6781 & 0.8525 & \ttfamily{0.7065} & \ttfamily{0.3533} & \ttfamily{0.6467}\\
\textbf{\cellcolor{gray!10}{3}} & \cellcolor{gray!10}{1.6678} & \cellcolor{gray!10}{1.6776} & \cellcolor{gray!10}{0.9941} & \ttfamily{\cellcolor{gray!10}{0.9464}} & \ttfamily{\cellcolor{gray!10}{0.4732}} & \ttfamily{\cellcolor{gray!10}{0.5268}}\\
\textbf{4} & 3.7257 & 2.8924 & 1.2881 & \ttfamily{0.3371} & \ttfamily{0.8315} & \ttfamily{0.1685}\\
\textbf{\cellcolor{gray!10}{5}} & \cellcolor{gray!10}{7.0993} & \cellcolor{gray!10}{4.4596} & \cellcolor{gray!10}{1.5919} & \ttfamily{\cellcolor{gray!10}{0.1935}} & \ttfamily{\cellcolor{gray!10}{0.9033}} & \ttfamily{\cellcolor{gray!10}{0.0967 *}}\\
\addlinespace
\textbf{6} & 11.6367 & 5.9961 & 1.9407 & \ttfamily{0.0913 *} & \ttfamily{0.9544} & \ttfamily{0.0456 **}\\
\textbf{\cellcolor{gray!10}{7}} & \cellcolor{gray!10}{18.5458} & \cellcolor{gray!10}{7.7500} & \cellcolor{gray!10}{2.3930} & \ttfamily{\cellcolor{gray!10}{0.1470}} & \ttfamily{\cellcolor{gray!10}{0.9265}} & \ttfamily{\cellcolor{gray!10}{0.0735 *}}\\
\textbf{8} & 27.9643 & 9.0357 & 3.0949 & \ttfamily{0.1615} & \ttfamily{0.9193} & \ttfamily{0.0807 *}\\
\textbf{\cellcolor{gray!10}{9}} & \cellcolor{gray!10}{40.1971} & \cellcolor{gray!10}{10.7260} & \cellcolor{gray!10}{3.7476} & \ttfamily{\cellcolor{gray!10}{0.1525}} & \ttfamily{\cellcolor{gray!10}{0.9238}} & \ttfamily{\cellcolor{gray!10}{0.0762 *}}\\
\textbf{10} & 55.4635 & 12.0156 & 4.6160 & \ttfamily{0.1044} & \ttfamily{0.9478} & \ttfamily{0.0522 *}\\
\bottomrule
\end{tabular}
\begin{tablenotes}[para]
\item \textit{Note:} 
\item TR refers to the forecast made with an estimated Taylor Rule. BM refers to a benchmark of the interest rate using an ARIMA model. Ratio < 1 indicates that the TR model has lower MSFE.
\item \textit{DM Test Alternative Hypotheses (H\_A):} 
\item[*] 'DM Greater' tests if the TR model is significantly more accurate than the BM model.
\item[\dag] 'DM Lesser' tests if the TR model is significantly less accurate than the BM model.
\end{tablenotes}
\end{threeparttable}}
\end{table}

\clearpage

\section{Actual Forecast Model}\label{actual-forecast-model}

\subsection{Helpers}\label{helpers-1}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# Helper function for displaying our final forecast results (table)}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}

\NormalTok{display\_forecasts }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(forecast\_list, }
                              \AttributeTok{caption =} \StringTok{"Interest Rate Forecasts"}\NormalTok{, }
                              \AttributeTok{format =} \StringTok{"html"}\NormalTok{) \{}
  
  \CommentTok{\# Determine the number of horizons and corresponding quarters}
\NormalTok{  H }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(forecast\_list}\SpecialCharTok{$}\NormalTok{TR\_Forecast)}
  
\NormalTok{  forecast\_quarters }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\AttributeTok{from =} \FunctionTok{last}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{quarter) }\SpecialCharTok{+} \FloatTok{0.25}\NormalTok{, }
                           \AttributeTok{by =} \FloatTok{0.25}\NormalTok{, }
                           \AttributeTok{length.out =}\NormalTok{ H)}
  
\NormalTok{  horizon\_quarter\_label }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\NormalTok{H, }\StringTok{": "}\NormalTok{, }\FunctionTok{as.character}\NormalTok{(forecast\_quarters))}
  
  \CommentTok{\# Create a data frame for display}
\NormalTok{  forecast\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
    \AttributeTok{Horizon\_Quarter =}\NormalTok{ horizon\_quarter\_label,}
    \AttributeTok{Taylor\_Rule\_Forecast =} \FunctionTok{round}\NormalTok{(forecast\_list}\SpecialCharTok{$}\NormalTok{TR\_Forecast,}\DecValTok{2}\NormalTok{),}
    \AttributeTok{Benchmark\_ARIMA\_Forecast =} \FunctionTok{round}\NormalTok{(forecast\_list}\SpecialCharTok{$}\NormalTok{BM\_Forecast,}\DecValTok{2}\NormalTok{),}
    \AttributeTok{Inflation\_Gap\_Forecast =} \FunctionTok{round}\NormalTok{(forecast\_list}\SpecialCharTok{$}\NormalTok{Inflation\_Forecast,}\DecValTok{2}\NormalTok{),}
    \AttributeTok{Output\_Gap\_Forecast =} \FunctionTok{round}\NormalTok{(forecast\_list}\SpecialCharTok{$}\NormalTok{OutputGap\_Forecast,}\DecValTok{2}\NormalTok{))}
  
  \CommentTok{\# Create the table}
\NormalTok{  table\_output }\OtherTok{\textless{}{-}} \FunctionTok{kable}\NormalTok{(}
\NormalTok{    forecast\_df,}
    \AttributeTok{format =}\NormalTok{ format,}
    \AttributeTok{digits =} \DecValTok{4}\NormalTok{,}
    \AttributeTok{col.names =} \FunctionTok{c}\NormalTok{(}\StringTok{"Horizon: Quarter"}\NormalTok{, }\StringTok{"Taylor Rule Forecast"}\NormalTok{, }\StringTok{"Benchmark Forecast"}\NormalTok{,}
                  \StringTok{"Inflation Forecast"}\NormalTok{, }\StringTok{"Output Gap Forecast"}\NormalTok{),}
    \AttributeTok{caption =}\NormalTok{ caption,}
    \AttributeTok{booktabs =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{(}
    \AttributeTok{latex\_options =} \StringTok{"striped"}\NormalTok{,}
    \AttributeTok{position =} \StringTok{"center"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{column\_spec}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{bold =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{border\_right =} \ConstantTok{TRUE}\NormalTok{)}
  \ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
    \FunctionTok{save\_kable}\NormalTok{(table\_output, }\FunctionTok{paste0}\NormalTok{(}\StringTok{"figures/"}\NormalTok{, caption, }\StringTok{".tex"}\NormalTok{))\} }
    \FunctionTok{return}\NormalTok{(table\_output) \}}


\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# Helper function for plotting our final forecast results}
\CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}

\NormalTok{plot\_forecasts }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(forecast\_list, }
                           \AttributeTok{title =} \StringTok{"Interest Rate and Component Forecasts"}\NormalTok{) \{}
  
  \CommentTok{\# Create the data frame for plotting w/ numerical quarters}
\NormalTok{  H }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(forecast\_list}\SpecialCharTok{$}\NormalTok{TR\_Forecast)}
\NormalTok{  forecast\_quarters\_yearqtr }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\AttributeTok{from =} \FunctionTok{last}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{quarter) }\SpecialCharTok{+} \FloatTok{0.25}\NormalTok{, }
                                     \AttributeTok{by =} \FloatTok{0.25}\NormalTok{, }
                                     \AttributeTok{length.out =}\NormalTok{ H)}
  
  \CommentTok{\# b) numeric version (for plotting)}
\NormalTok{  forecast\_quarters\_numeric }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(forecast\_quarters\_yearqtr)}
  
  \CommentTok{\# c) character version (for labels)}
\NormalTok{  forecast\_quarters\_labels }\OtherTok{\textless{}{-}} \FunctionTok{as.character}\NormalTok{(forecast\_quarters\_yearqtr)}
  
\NormalTok{  forecast\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
    \AttributeTok{Quarter =}\NormalTok{ forecast\_quarters\_numeric,}
    \StringTok{"Taylor Rule"} \OtherTok{=}\NormalTok{ forecast\_list}\SpecialCharTok{$}\NormalTok{TR\_Forecast,}
    \StringTok{"Benchmark ARIMA"} \OtherTok{=}\NormalTok{ forecast\_list}\SpecialCharTok{$}\NormalTok{BM\_Forecast,}
    \StringTok{"Inflation"} \OtherTok{=}\NormalTok{ forecast\_list}\SpecialCharTok{$}\NormalTok{Inflation\_Forecast,}
    \StringTok{"Output Gap"} \OtherTok{=}\NormalTok{ forecast\_list}\SpecialCharTok{$}\NormalTok{OutputGap\_Forecast,}
    \AttributeTok{check.names =} \ConstantTok{FALSE}\NormalTok{ )}
  
  \CommentTok{\# Long format for ggplot }
\NormalTok{  forecast\_long }\OtherTok{\textless{}{-}}\NormalTok{ forecast\_df }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \SpecialCharTok{{-}}\NormalTok{Quarter, }
      \AttributeTok{names\_to =} \StringTok{"Forecast\_Type"}\NormalTok{,}
      \AttributeTok{values\_to =} \StringTok{"Value"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Plot\_Group =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{           Forecast\_Type }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"Taylor Rule"}\NormalTok{, }\StringTok{"Benchmark ARIMA"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}} \StringTok{"Interest Rate Forecasts"}\NormalTok{,}
\NormalTok{           Forecast\_Type }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"Inflation"}\NormalTok{, }\StringTok{"Output Gap"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}} \StringTok{"Model Input Forecasts"}\NormalTok{),}
      \AttributeTok{Plot\_Group =} \FunctionTok{factor}\NormalTok{(Plot\_Group, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Interest Rate Forecasts"}\NormalTok{, }\StringTok{"Model Input Forecasts"}\NormalTok{)),}
      \AttributeTok{Forecast\_Type =} \FunctionTok{factor}\NormalTok{(Forecast\_Type, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Taylor Rule"}\NormalTok{, }\StringTok{"Benchmark ARIMA"}\NormalTok{, }\StringTok{"Inflation"}\NormalTok{, }\StringTok{"Output Gap"}\NormalTok{)))}

  \CommentTok{\# Actual plot}
\NormalTok{  plot }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(forecast\_long, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Quarter, }\AttributeTok{y =}\NormalTok{ Value, }\AttributeTok{color =}\NormalTok{ Forecast\_Type)) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{linewidth =} \FloatTok{1.1}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \FloatTok{2.5}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ Plot\_Group, }\AttributeTok{ncol =} \DecValTok{1}\NormalTok{, }\AttributeTok{scales =} \StringTok{"free\_y"}\NormalTok{) }\SpecialCharTok{+}
    \CommentTok{\# Prettyness}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =}\NormalTok{ title,}
         \AttributeTok{x =} \StringTok{"Quarter"}\NormalTok{,}
         \AttributeTok{y =} \StringTok{"Value (\%)"}\NormalTok{,}
         \AttributeTok{color =} \StringTok{"Forecast Series"}\NormalTok{,}
    \AttributeTok{subtitle =} \FunctionTok{paste}\NormalTok{(}\StringTok{"For model based on:"}\NormalTok{, model\_name)) }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =}\NormalTok{ forecast\_quarters\_numeric, }
                       \AttributeTok{labels =}\NormalTok{ forecast\_quarters\_labels) }\SpecialCharTok{+} 
    \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{14}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"bottom"}\NormalTok{,}
          \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{5}\NormalTok{)),}
          \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey30"}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{10}\NormalTok{)),}
          \AttributeTok{axis.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
          \AttributeTok{axis.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{),}
          \AttributeTok{strip.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{12}\NormalTok{), }
          \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{)  ) }\SpecialCharTok{+}
          \FunctionTok{scale\_color\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Set1"}\NormalTok{) }
  \FunctionTok{return}\NormalTok{(plot) \}}
\end{Highlighting}
\end{Shaded}

\subsection{Forecasting}\label{forecasting}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Formula 4 seems to work best}
\NormalTok{our\_predict }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(data,formula,H)\{}

  \CommentTok{\# {-}{-}{-} 1. Fit inputs and benchmark models  {-}{-}{-}}
\NormalTok{   inflation\_arma }\OtherTok{\textless{}{-}} \FunctionTok{my.auto.arima}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{inflation\_gap, }\AttributeTok{max.p=}\DecValTok{4}\NormalTok{, }\AttributeTok{max.q=}\DecValTok{4}\NormalTok{, }\AttributeTok{d=}\DecValTok{1}\NormalTok{, }\AttributeTok{var\_name=}\StringTok{"Inflation Gap"}\NormalTok{)}
\NormalTok{   outputgap\_arma }\OtherTok{\textless{}{-}} \FunctionTok{my.auto.arima}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{output\_gap, }\AttributeTok{max.p=}\DecValTok{4}\NormalTok{, }\AttributeTok{max.q=}\DecValTok{4}\NormalTok{, }\AttributeTok{d=}\DecValTok{0}\NormalTok{, }\AttributeTok{var\_name=}\StringTok{"Output Gap"}\NormalTok{)}
\NormalTok{   interest\_arma }\OtherTok{\textless{}{-}} \FunctionTok{my.auto.arima}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{rate, }\AttributeTok{max.p=}\DecValTok{4}\NormalTok{, }\AttributeTok{max.q=}\DecValTok{4}\NormalTok{, }\AttributeTok{d=}\DecValTok{1}\NormalTok{, }\AttributeTok{var\_name=}\StringTok{"Interest Rate"}\NormalTok{) }\CommentTok{\# Benchmark}
  
  \CommentTok{\# {-}{-}{-} 2. Get forecasts of inputs (all H horizons) {-}{-}{-}}
\NormalTok{   inflation\_forecasts }\OtherTok{\textless{}{-}} \FunctionTok{my.forecast}\NormalTok{(inflation\_arma, }\AttributeTok{h =}\NormalTok{ H)}
\NormalTok{   outputgap\_forecasts }\OtherTok{\textless{}{-}} \FunctionTok{my.forecast}\NormalTok{(outputgap\_arma, }\AttributeTok{h =}\NormalTok{ H)}
\NormalTok{   BMpredicted\_rates }\OtherTok{\textless{}{-}} \FunctionTok{my.forecast}\NormalTok{(interest\_arma, }\AttributeTok{h =}\NormalTok{ H)}
  
  \CommentTok{\# {-}{-}{-} 3. Fit TR model}
\NormalTok{   TR\_model }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(formula, }\AttributeTok{data =}\NormalTok{ data)}
    
  \CommentTok{\# {-}{-}{-} 4. Build forecast input data frame (iteratively for lags) {-}{-}{-}}
   
   \CommentTok{\# Allocate storage for full horizon}
\NormalTok{   TR\_preds }\OtherTok{\textless{}{-}} \FunctionTok{numeric}\NormalTok{(H)}
   
   \CommentTok{\# Get last known lags (starting point for lagged models)}
\NormalTok{   current\_shadowrate\_lag }\OtherTok{\textless{}{-}} \FunctionTok{last}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{shadowrate)}
\NormalTok{   current\_rate\_lag }\OtherTok{\textless{}{-}} \FunctionTok{last}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{rate)}
   
  \ControlFlowTok{for}\NormalTok{ (h }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{H) \{}
\NormalTok{     new\_data\_h }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
        \AttributeTok{inflation\_gap =}\NormalTok{ inflation\_forecasts[h],}
        \AttributeTok{output\_gap =}\NormalTok{ outputgap\_forecasts[h],}
        \AttributeTok{shadowrate\_lag =}\NormalTok{ current\_shadowrate\_lag,}
        \AttributeTok{rate\_lag =}\NormalTok{ current\_rate\_lag)}
     
     \CommentTok{\# Get forecasted values}
\NormalTok{     pred\_h }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(TR\_model, new\_data\_h)}
\NormalTok{     TR\_preds[h] }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(}\FunctionTok{pmax}\NormalTok{(pred\_h, }\FunctionTok{min}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{rate)) }\SpecialCharTok{/} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{*} \FloatTok{0.25}
     
     \CommentTok{\# Update the lag for h+1}
\NormalTok{     current\_rate\_lag }\OtherTok{\textless{}{-}}\NormalTok{ pred\_h \}}
     
   \CommentTok{\# {-}{-}{-} 5. Compute forecast for BM {-}{-}{-}}
\NormalTok{    BM\_preds }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(}\FunctionTok{pmax}\NormalTok{(BMpredicted\_rates, }\FunctionTok{min}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{rate)) }\SpecialCharTok{/} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{*} \FloatTok{0.25} 
    
  \FunctionTok{return}\NormalTok{(}\FunctionTok{list}\NormalTok{(}\AttributeTok{TR\_Forecast =}\NormalTok{ TR\_preds, }
                \AttributeTok{BM\_Forecast =}\NormalTok{ BM\_preds,}
                \AttributeTok{Inflation\_Forecast =}\NormalTok{ inflation\_forecasts }\SpecialCharTok{+} \DecValTok{2}\NormalTok{, }\CommentTok{\#to add back target }
                \AttributeTok{OutputGap\_Forecast =}\NormalTok{ outputgap\_forecasts,  }
                \AttributeTok{inflation\_gap\_arma\_coef =}\NormalTok{ inflation\_arma}\SpecialCharTok{$}\NormalTok{coef,}
                \AttributeTok{output\_gap\_arma\_coef =}\NormalTok{ outputgap\_arma}\SpecialCharTok{$}\NormalTok{coef,}
                \AttributeTok{benchmark\_arma\_coef =}\NormalTok{ interest\_arma}\SpecialCharTok{$}\NormalTok{coef,}
                \AttributeTok{inflation\_gap\_arma\_var =}\NormalTok{ inflation\_arma}\SpecialCharTok{$}\NormalTok{sigma2,}
                \AttributeTok{output\_gap\_arma\_var =}\NormalTok{ outputgap\_arma}\SpecialCharTok{$}\NormalTok{sigma2,}
                \AttributeTok{benchmark\_arma\_var =}\NormalTok{ interest\_arma}\SpecialCharTok{$}\NormalTok{sigma2))\}}

 
\NormalTok{final\_forecasts }\OtherTok{\textless{}{-}} \FunctionTok{our\_predict}\NormalTok{(}\AttributeTok{data =}\NormalTok{ data, }\AttributeTok{formula =}\NormalTok{ model\_formula, }\AttributeTok{H =}\NormalTok{ H)}
\end{Highlighting}
\end{Shaded}

{[}1{]} ``This model is fitted to the variable `Inflation Gap' specified
as ARIMA(1, 1, 4).'' {[}1{]} ``This model is fitted to the variable
`Output Gap' specified as ARIMA(4, 0, 1).'' {[}1{]} ``This model is
fitted to the variable `Interest Rate' specified as ARIMA(2, 1, 1).''

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{display\_forecasts}\NormalTok{(final\_forecasts, }
                  \AttributeTok{caption =} \FunctionTok{paste}\NormalTok{(}\StringTok{"For model based on:"}\NormalTok{, model\_name),}
                  \AttributeTok{format =}\NormalTok{ format)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\caption{\label{tab:forecast}For model based on: F_TR_FORMULA_4}
\centering
\begin{tabular}[t]{>{}l|rrrr}
\toprule
Horizon: Quarter & Taylor Rule Forecast & Benchmark Forecast & Inflation Forecast & Output Gap Forecast\\
\midrule
\textbf{\cellcolor{gray!10}{1: 2025 Q3}} & \cellcolor{gray!10}{2.00} & \cellcolor{gray!10}{1.75} & \cellcolor{gray!10}{1.98} & \cellcolor{gray!10}{0.32}\\
\textbf{2: 2025 Q4} & 1.75 & 1.25 & 2.04 & 0.19\\
\textbf{\cellcolor{gray!10}{3: 2026 Q1}} & \cellcolor{gray!10}{1.75} & \cellcolor{gray!10}{1.25} & \cellcolor{gray!10}{1.85} & \cellcolor{gray!10}{0.04}\\
\textbf{4: 2026 Q2} & 1.50 & 1.00 & 1.91 & -0.12\\
\textbf{\cellcolor{gray!10}{5: 2026 Q3}} & \cellcolor{gray!10}{1.50} & \cellcolor{gray!10}{1.00} & \cellcolor{gray!10}{1.95} & \cellcolor{gray!10}{-0.21}\\
\addlinespace
\textbf{6: 2026 Q4} & 1.50 & 1.00 & 1.98 & -0.26\\
\textbf{\cellcolor{gray!10}{7: 2027 Q1}} & \cellcolor{gray!10}{1.25} & \cellcolor{gray!10}{1.25} & \cellcolor{gray!10}{2.00} & \cellcolor{gray!10}{-0.29}\\
\textbf{8: 2027 Q2} & 1.25 & 1.25 & 2.01 & -0.28\\
\textbf{\cellcolor{gray!10}{9: 2027 Q3}} & \cellcolor{gray!10}{1.25} & \cellcolor{gray!10}{1.25} & \cellcolor{gray!10}{2.02} & \cellcolor{gray!10}{-0.24}\\
\textbf{10: 2027 Q4} & 1.25 & 1.25 & 2.03 & -0.19\\
\bottomrule
\end{tabular}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{final\_fc\_plot1 }\OtherTok{\textless{}{-}} \FunctionTok{plot\_forecasts}\NormalTok{(final\_forecasts)}
\NormalTok{final\_fc\_plot1}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{ECB-Project_files/figure-latex/forecast-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (save\_figures) \{}
  \FunctionTok{ggsave}\NormalTok{(}\AttributeTok{filename =} \StringTok{"actual\_forecasts\_plot.png"}\NormalTok{, }\AttributeTok{path =} \StringTok{"figures/"}\NormalTok{, }\AttributeTok{plot=}\NormalTok{final\_fc\_plot1)\}}
\end{Highlighting}
\end{Shaded}

\section{Prediction Intervals}\label{prediction-intervals}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{prediction }\OtherTok{\textless{}{-}}\NormalTok{ var\_by\_horizon}
\NormalTok{final\_interval }\OtherTok{\textless{}{-}}\NormalTok{ final\_forecasts[}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{)]}
\NormalTok{prediction}\SpecialCharTok{$}\NormalTok{sd\_fe }\OtherTok{\textless{}{-}} \FunctionTok{sqrt}\NormalTok{(prediction}\SpecialCharTok{$}\NormalTok{var\_fe)}

\NormalTok{final\_interval}\SpecialCharTok{$}\NormalTok{sd }\OtherTok{\textless{}{-}}\NormalTok{ prediction}\SpecialCharTok{$}\NormalTok{sd\_fe}
\NormalTok{final\_interval}\SpecialCharTok{$}\NormalTok{upper\_1\_sd }\OtherTok{\textless{}{-}}\NormalTok{ final\_interval}\SpecialCharTok{$}\NormalTok{sd }\SpecialCharTok{+}\NormalTok{ final\_interval}\SpecialCharTok{$}\NormalTok{TR\_Forecast}
\NormalTok{final\_interval}\SpecialCharTok{$}\NormalTok{lower\_1\_sd }\OtherTok{\textless{}{-}}\NormalTok{ final\_interval}\SpecialCharTok{$}\NormalTok{sd}\SpecialCharTok{*}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{) }\SpecialCharTok{+}\NormalTok{ final\_interval}\SpecialCharTok{$}\NormalTok{TR\_Forecast}

\NormalTok{final\_interval}\SpecialCharTok{$}\NormalTok{upper\_2\_sd }\OtherTok{\textless{}{-}}\NormalTok{ final\_interval}\SpecialCharTok{$}\NormalTok{sd}\SpecialCharTok{*}\DecValTok{2} \SpecialCharTok{+}\NormalTok{ final\_interval}\SpecialCharTok{$}\NormalTok{TR\_Forecast}
\NormalTok{final\_interval}\SpecialCharTok{$}\NormalTok{lower\_2\_sd }\OtherTok{\textless{}{-}}\NormalTok{ final\_interval}\SpecialCharTok{$}\NormalTok{sd}\SpecialCharTok{*}\DecValTok{2}\SpecialCharTok{*}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{) }\SpecialCharTok{+}\NormalTok{ final\_interval}\SpecialCharTok{$}\NormalTok{TR\_Forecast}

\NormalTok{final\_interval }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(final\_interval)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# PIMPed forecast plot}
\NormalTok{final\_fc\_plot2 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(final\_interval, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{seq\_len}\NormalTok{(}\FunctionTok{nrow}\NormalTok{(final\_interval)), }\AttributeTok{y =}\NormalTok{ TR\_Forecast, }\AttributeTok{group =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
  
  \CommentTok{\# {-}{-}{-} 1. Confidence/Prediction Intervals {-}{-}{-}}
  \CommentTok{\# 2{-}Standard Deviation Band (e.g., \textasciitilde{}95\% Interval for Normal Errors)}
  \FunctionTok{geom\_ribbon}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{ymin =}\NormalTok{ lower\_2\_sd, }\AttributeTok{ymax =}\NormalTok{ upper\_2\_sd), }\AttributeTok{fill =} \StringTok{"\#b3cde3"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\# 1{-}Standard Deviation Band (e.g., \textasciitilde{}68\% Interval)}
  \FunctionTok{geom\_ribbon}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{ymin =}\NormalTok{ lower\_1\_sd, }\AttributeTok{ymax =}\NormalTok{ upper\_1\_sd), }\AttributeTok{fill =} \StringTok{"\#8856a7"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{color =} \StringTok{"\#4c78a8"}\NormalTok{, }\AttributeTok{size =} \FloatTok{1.2}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"solid"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{color =} \StringTok{"\#4c78a8"}\NormalTok{, }\AttributeTok{size =} \DecValTok{3}\NormalTok{, }\AttributeTok{shape =} \DecValTok{21}\NormalTok{, }\AttributeTok{fill =} \StringTok{"white"}\NormalTok{, }\AttributeTok{stroke =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Monetary Policy Rate Forecast with Uncertainty Bands"}\NormalTok{,}
       \AttributeTok{subtitle =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Model: Taylor Rule with"}\NormalTok{, model\_name, }\StringTok{"| Confidence Bands based on Standard Error"}\NormalTok{),}
       \AttributeTok{caption =} \StringTok{"Inner band: 1 S.D. (approx. 68\%); Outer band: 2 S.D. (approx. 95\%)"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Forecast Horizon (h{-}steps ahead)"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Interest Rate (\%)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_light}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{16}\NormalTok{, }\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{7}\NormalTok{)),}
        \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{color =} \StringTok{"\#555555"}\NormalTok{, }\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{b=}\DecValTok{5}\NormalTok{)),}
        \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{9}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey50"}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{0}\NormalTok{),}
        \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{t=}\DecValTok{10}\NormalTok{)),}
        \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{r=}\DecValTok{10}\NormalTok{)),}
        \AttributeTok{panel.grid.major.x =} \FunctionTok{element\_blank}\NormalTok{(), }
        \AttributeTok{panel.grid.minor.x =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{0}\NormalTok{, }\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{) )}
\NormalTok{final\_fc\_plot2}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{ECB-Project_files/figure-latex/prediction_intervals_plot-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ce graph c est le old ou le new? }

\CommentTok{\# Get last observation}
\NormalTok{H }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(final\_interval}\SpecialCharTok{$}\NormalTok{TR\_Forecast)}
\NormalTok{forecast\_quarters\_yearqtr }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\AttributeTok{from =} \FunctionTok{last}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{quarter) }\SpecialCharTok{+} \FloatTok{0.25}\NormalTok{, }
                                 \AttributeTok{by =} \FloatTok{0.25}\NormalTok{, }
                                 \AttributeTok{length.out =}\NormalTok{ H)}
 
\CommentTok{\# Get numeric values}
\NormalTok{forecast\_quarters\_numeric }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(forecast\_quarters\_yearqtr)}
 
\CommentTok{\# Turn into characters}
\NormalTok{forecast\_quarters\_labels }\OtherTok{\textless{}{-}} \FunctionTok{as.character}\NormalTok{(forecast\_quarters\_yearqtr)}

\CommentTok{\# Plot the forecast plot}
\NormalTok{final\_fc\_plot2 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(final\_interval, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ forecast\_quarters\_numeric, }\AttributeTok{y =}\NormalTok{ TR\_Forecast, }\AttributeTok{group =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}

  \CommentTok{\#Prediction INtervall}
  \FunctionTok{geom\_ribbon}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{ymin =}\NormalTok{ lower\_2\_sd, }\AttributeTok{ymax =}\NormalTok{ upper\_2\_sd), }\AttributeTok{fill =} \StringTok{"\#C0C0C0"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_ribbon}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{ymin =}\NormalTok{ lower\_1\_sd, }\AttributeTok{ymax =}\NormalTok{ upper\_1\_sd), }\AttributeTok{fill =} \StringTok{"\#A9A9A9"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  
  \CommentTok{\# Forecast Line}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{color =} \StringTok{"\#3A3A66"}\NormalTok{, }\AttributeTok{size =} \FloatTok{1.2}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"solid"}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\# Forecast Points (Slightly smaller, matching line color)}
  
  \CommentTok{\# update the x axis with quarters}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}
    \CommentTok{\# Use the calculated numeric quarters for breaks}
    \AttributeTok{breaks =}\NormalTok{ forecast\_quarters\_numeric,}
    \CommentTok{\# Use the calculated Year{-}Quarter strings for labels}
    \AttributeTok{labels =}\NormalTok{ forecast\_quarters\_labels) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"ECB Deposit Facility Rate Forecast"}\NormalTok{,}
         \AttributeTok{subtitle =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Model: Taylor Rule with"}\NormalTok{, model\_name, }\StringTok{"| Confidence Bands based on Standard Error"}\NormalTok{),}
         \AttributeTok{caption =} \StringTok{"Inner band: 1 S.D. (approx. 68\%); Outer band: 2 S.D. (approx. 95\%)"}\NormalTok{,}
         \AttributeTok{y =} \StringTok{"Interest Rate (\%)"}\NormalTok{, }\AttributeTok{x =} \StringTok{""}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_light}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{16}\NormalTok{, }\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{),}
        \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{color =} \StringTok{"\#555555"}\NormalTok{, }\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{),}
        \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{t=}\DecValTok{10}\NormalTok{)),}
        \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{, }\AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{r=}\DecValTok{10}\NormalTok{)),}
        \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{9}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey50"}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{0}\NormalTok{),}
        \AttributeTok{panel.grid.major.x =} \FunctionTok{element\_blank}\NormalTok{(), }
        \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{, }\AttributeTok{size =} \DecValTok{10}\NormalTok{))}
\NormalTok{final\_fc\_plot2}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{ECB-Project_files/figure-latex/temporary prediction interval-1.pdf}}

\end{document}
